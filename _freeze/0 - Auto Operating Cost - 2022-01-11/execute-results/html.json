{
  "hash": "edbe412b73b12bf5b96dbfa39f347556",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Auto Operating Costs Calculation\nsubtitle: Estimating Auto Operating Costs for Travel Demand Model\nauthor:\n - name: Pukar Bhandari\n   email: pukar.bhandari@wfrc.utah.gov\n   affiliation:\n     - name: Wasatch Front Regional Council\n       url: \"https://wfrc.utah.gov/\"\ndate: \"2025-09-17\"\n---\n\nThis document is just replicating the excel sheet located in `/archive-v9.0/1 - Auto Operating Costs - 2022-01-11.xlsx`.\n\n## Import Libraries\n\n``` python\n!pip install pandas openpyxl\n# OR\n!conda install pandas openpyxl\n```\n\n::: {#9771db64 .cell execution_count=1}\n``` {.python .cell-code}\n# For Analysis\nimport numpy as np\nimport pandas as pd\n\n# For Visualization\nimport matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\nfrom matplotlib.ticker import FuncFormatter\nimport seaborn as sns\nfrom scipy.interpolate import make_interp_spline\nfrom scipy import stats\n\n# For Date time processing\nimport datetime\n```\n:::\n\n\n## Read Raw Data\n\n### 3-11\n\nTable 3-11: Sales Price of Transportation Fuel to End-Users \\[Source: [Bureau of Transportation Statistics](https://www.bts.gov/content/sales-price-transportation-fuel-end-users-current-cents-gallon)\\]\n\nFile URL: https://www.bts.gov/sites/bts.dot.gov/files/2024-03/table_03_11_032824.xlsx\n\n::: {#4700051b .cell execution_count=2}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_3_11 = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Auto Cost & Gas Price.xlsx\",\n  sheet_name=\"3-11\",\n  header=1,\n  usecols=\"A:AH\", # TODO: update cols later for new data\n  nrows=10\n)\n\n# display the data\ndf_3_11\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>1995</th>\n      <th>1996</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Aviation fuel (excluding taxes)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Aviation gasolinea</td>\n      <td>108.4</td>\n      <td>120.10</td>\n      <td>112.00</td>\n      <td>104.70</td>\n      <td>102.70</td>\n      <td>99.00</td>\n      <td>95.70</td>\n      <td>100.50</td>\n      <td>111.60</td>\n      <td>...</td>\n      <td>380.30</td>\n      <td>397.1</td>\n      <td>393.20</td>\n      <td>398.6</td>\n      <td>W</td>\n      <td>W</td>\n      <td>W</td>\n      <td>W</td>\n      <td>W</td>\n      <td>263.9</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Jet fuel kerosenea</td>\n      <td>86.8</td>\n      <td>79.60</td>\n      <td>76.60</td>\n      <td>65.20</td>\n      <td>61.00</td>\n      <td>58.00</td>\n      <td>53.40</td>\n      <td>54.00</td>\n      <td>65.10</td>\n      <td>...</td>\n      <td>305.40</td>\n      <td>310.4</td>\n      <td>297.90</td>\n      <td>277.2</td>\n      <td>162.9</td>\n      <td>131.9</td>\n      <td>162.9</td>\n      <td>211.9</td>\n      <td>197</td>\n      <td>121.8</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Highway fuel (including taxes)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Gasoline, premiumb</td>\n      <td>N</td>\n      <td>134.00</td>\n      <td>134.90</td>\n      <td>132.10</td>\n      <td>131.60</td>\n      <td>130.20</td>\n      <td>130.50</td>\n      <td>133.60</td>\n      <td>141.30</td>\n      <td>...</td>\n      <td>379.20</td>\n      <td>392.2</td>\n      <td>384.30</td>\n      <td>371.3</td>\n      <td>286.6</td>\n      <td>261</td>\n      <td>291.1</td>\n      <td>327</td>\n      <td>321.2</td>\n      <td>279.1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Gasoline, regularb</td>\n      <td>124.5</td>\n      <td>120.20</td>\n      <td>116.40</td>\n      <td>114.00</td>\n      <td>112.70</td>\n      <td>110.80</td>\n      <td>111.20</td>\n      <td>114.70</td>\n      <td>123.10</td>\n      <td>...</td>\n      <td>352.70</td>\n      <td>364.4</td>\n      <td>352.60</td>\n      <td>336.7</td>\n      <td>244.8</td>\n      <td>214.2</td>\n      <td>240.8</td>\n      <td>273.5</td>\n      <td>263.6</td>\n      <td>217.4</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Gasoline, all types</td>\n      <td>122.1</td>\n      <td>119.60</td>\n      <td>121.70</td>\n      <td>119.60</td>\n      <td>119.00</td>\n      <td>117.30</td>\n      <td>117.40</td>\n      <td>120.50</td>\n      <td>128.80</td>\n      <td>...</td>\n      <td>357.70</td>\n      <td>369.5</td>\n      <td>358.40</td>\n      <td>342.5</td>\n      <td>251.0</td>\n      <td>220.4</td>\n      <td>246.9</td>\n      <td>279.4</td>\n      <td>269.8</td>\n      <td>224.2</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Diesel no. 2 (excluding taxes)a</td>\n      <td>81.8</td>\n      <td>78.90</td>\n      <td>72.50</td>\n      <td>64.80</td>\n      <td>61.90</td>\n      <td>60.20</td>\n      <td>55.40</td>\n      <td>56.00</td>\n      <td>68.10</td>\n      <td>...</td>\n      <td>311.70</td>\n      <td>320.2</td>\n      <td>312.20</td>\n      <td>292.3</td>\n      <td>181.9</td>\n      <td>151.1</td>\n      <td>181.1</td>\n      <td>225.6</td>\n      <td>211.4</td>\n      <td>147.7</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Railroad fuel</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Diesel</td>\n      <td>82.64</td>\n      <td>77.76</td>\n      <td>69.22</td>\n      <td>67.24</td>\n      <td>63.29</td>\n      <td>63.05</td>\n      <td>59.87</td>\n      <td>60.01</td>\n      <td>67.66</td>\n      <td>...</td>\n      <td>307.07</td>\n      <td>316.7</td>\n      <td>312.37</td>\n      <td>294.7</td>\n      <td>179.14</td>\n      <td>143.97</td>\n      <td>177.08</td>\n      <td>223</td>\n      <td>205.07</td>\n      <td>U</td>\n    </tr>\n  </tbody>\n</table>\n<p>10 rows × 34 columns</p>\n</div>\n```\n:::\n:::\n\n\n### 3-12\n\nTable 3-12: Price Trends of Gasoline v. Other Consumer Goods and Services \\[Source: [Bureau of Transportation Statistics](https://www.bts.gov/content/price-trends-gasoline-v-other-consumer-goods-and-services)\\]\n\nFile URL: https://www.bts.gov/sites/bts.dot.gov/files/2024-03/table_03_12_032824_1.xlsx\n\n::: {#b1f2c0ec .cell execution_count=3}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_3_12 = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Auto Cost & Gas Price.xlsx\",\n  sheet_name=\"3-12\",\n  header=1,\n  usecols=\"A:AJ\", # TODO: update cols later for new data\n  nrows=15\n)\n\n# display the data\ndf_3_12\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Retail price of motor gasoline, all types (con...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Total service station price</td>\n      <td>1.922553</td>\n      <td>2.196066</td>\n      <td>2.926173</td>\n      <td>2.198561</td>\n      <td>1.873159</td>\n      <td>1.776215</td>\n      <td>1.724424</td>\n      <td>1.657985</td>\n      <td>1.625456</td>\n      <td>...</td>\n      <td>3.296684</td>\n      <td>3.334806</td>\n      <td>3.187406</td>\n      <td>2.995277</td>\n      <td>2.191304</td>\n      <td>1.899656</td>\n      <td>2.083261</td>\n      <td>2.301386</td>\n      <td>2.182764</td>\n      <td>1.791483</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Service station price excluding taxes</td>\n      <td>1.327628</td>\n      <td>1.718324</td>\n      <td>2.578960</td>\n      <td>1.829438</td>\n      <td>1.514689</td>\n      <td>1.356071</td>\n      <td>1.295927</td>\n      <td>1.149847</td>\n      <td>1.121620</td>\n      <td>...</td>\n      <td>2.930058</td>\n      <td>2.973528</td>\n      <td>2.829018</td>\n      <td>2.637042</td>\n      <td>1.812043</td>\n      <td>1.525051</td>\n      <td>1.695129</td>\n      <td>1.931261</td>\n      <td>1.808475</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Average motor gasoline taxesa</td>\n      <td>0.594925</td>\n      <td>0.477742</td>\n      <td>0.347213</td>\n      <td>0.369123</td>\n      <td>0.358471</td>\n      <td>0.420143</td>\n      <td>0.428498</td>\n      <td>0.508138</td>\n      <td>0.503836</td>\n      <td>...</td>\n      <td>0.366626</td>\n      <td>0.361278</td>\n      <td>0.358387</td>\n      <td>0.358235</td>\n      <td>0.379261</td>\n      <td>0.374605</td>\n      <td>0.388133</td>\n      <td>0.370124</td>\n      <td>0.374290</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Retail price of motor gasoline, all types (cur...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Total service station price</td>\n      <td>0.360000</td>\n      <td>0.570000</td>\n      <td>1.221000</td>\n      <td>1.196000</td>\n      <td>1.217000</td>\n      <td>1.196000</td>\n      <td>1.190000</td>\n      <td>1.173000</td>\n      <td>1.174000</td>\n      <td>...</td>\n      <td>3.577000</td>\n      <td>3.695000</td>\n      <td>3.584000</td>\n      <td>3.425000</td>\n      <td>2.510000</td>\n      <td>2.204000</td>\n      <td>2.469000</td>\n      <td>2.794000</td>\n      <td>2.698000</td>\n      <td>2.242</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Service station price excluding taxes</td>\n      <td>0.248600</td>\n      <td>0.446000</td>\n      <td>1.083000</td>\n      <td>0.995200</td>\n      <td>0.984100</td>\n      <td>0.913100</td>\n      <td>0.894300</td>\n      <td>0.813500</td>\n      <td>0.810100</td>\n      <td>...</td>\n      <td>3.179200</td>\n      <td>3.294700</td>\n      <td>3.181020</td>\n      <td>3.015370</td>\n      <td>2.075580</td>\n      <td>1.769380</td>\n      <td>2.009000</td>\n      <td>2.344650</td>\n      <td>2.235360</td>\n      <td>2.058</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Average motor gasoline taxesa</td>\n      <td>0.111400</td>\n      <td>0.124000</td>\n      <td>0.138000</td>\n      <td>0.200800</td>\n      <td>0.232900</td>\n      <td>0.282900</td>\n      <td>0.295700</td>\n      <td>0.359500</td>\n      <td>0.363900</td>\n      <td>...</td>\n      <td>0.397800</td>\n      <td>0.400300</td>\n      <td>0.402980</td>\n      <td>0.409630</td>\n      <td>0.434420</td>\n      <td>0.434620</td>\n      <td>0.460000</td>\n      <td>0.449350</td>\n      <td>0.462640</td>\n      <td>0.184</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Consumer price indices (1982-84 = 100)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>All items</td>\n      <td>38.800000</td>\n      <td>53.800000</td>\n      <td>82.400000</td>\n      <td>107.600000</td>\n      <td>130.700000</td>\n      <td>136.200000</td>\n      <td>140.300000</td>\n      <td>144.500000</td>\n      <td>148.200000</td>\n      <td>...</td>\n      <td>224.939000</td>\n      <td>229.594000</td>\n      <td>232.957000</td>\n      <td>236.736000</td>\n      <td>237.017000</td>\n      <td>240.007000</td>\n      <td>245.120000</td>\n      <td>251.107000</td>\n      <td>255.657000</td>\n      <td>258.811</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Food</td>\n      <td>39.200000</td>\n      <td>59.800000</td>\n      <td>86.800000</td>\n      <td>105.600000</td>\n      <td>132.400000</td>\n      <td>136.300000</td>\n      <td>137.900000</td>\n      <td>140.900000</td>\n      <td>144.300000</td>\n      <td>...</td>\n      <td>227.842000</td>\n      <td>233.777000</td>\n      <td>237.037000</td>\n      <td>242.725000</td>\n      <td>247.235000</td>\n      <td>247.931000</td>\n      <td>250.065000</td>\n      <td>253.558000</td>\n      <td>258.316000</td>\n      <td>267.219</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Shelter</td>\n      <td>35.500000</td>\n      <td>48.800000</td>\n      <td>81.000000</td>\n      <td>109.800000</td>\n      <td>140.000000</td>\n      <td>146.300000</td>\n      <td>151.200000</td>\n      <td>155.700000</td>\n      <td>160.500000</td>\n      <td>...</td>\n      <td>251.646000</td>\n      <td>257.083000</td>\n      <td>263.056000</td>\n      <td>270.513000</td>\n      <td>278.803000</td>\n      <td>288.230000</td>\n      <td>297.803000</td>\n      <td>307.663000</td>\n      <td>318.053000</td>\n      <td>325.886</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Apparel</td>\n      <td>59.200000</td>\n      <td>72.500000</td>\n      <td>90.900000</td>\n      <td>105.000000</td>\n      <td>124.100000</td>\n      <td>128.700000</td>\n      <td>131.900000</td>\n      <td>133.700000</td>\n      <td>133.400000</td>\n      <td>...</td>\n      <td>122.111000</td>\n      <td>126.265000</td>\n      <td>127.411000</td>\n      <td>127.514000</td>\n      <td>125.903000</td>\n      <td>126.045000</td>\n      <td>125.612000</td>\n      <td>125.654000</td>\n      <td>124.052000</td>\n      <td>118.079</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Motor fuel</td>\n      <td>27.900000</td>\n      <td>45.100000</td>\n      <td>97.400000</td>\n      <td>98.700000</td>\n      <td>101.200000</td>\n      <td>99.400000</td>\n      <td>99.000000</td>\n      <td>98.000000</td>\n      <td>98.500000</td>\n      <td>...</td>\n      <td>302.619000</td>\n      <td>312.660000</td>\n      <td>303.850000</td>\n      <td>292.435000</td>\n      <td>213.062000</td>\n      <td>188.389000</td>\n      <td>212.721000</td>\n      <td>241.861000</td>\n      <td>233.234000</td>\n      <td>195.242</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Medical care</td>\n      <td>34.000000</td>\n      <td>47.500000</td>\n      <td>74.900000</td>\n      <td>113.500000</td>\n      <td>162.800000</td>\n      <td>177.000000</td>\n      <td>190.100000</td>\n      <td>201.400000</td>\n      <td>211.000000</td>\n      <td>...</td>\n      <td>400.258000</td>\n      <td>414.924000</td>\n      <td>425.134000</td>\n      <td>435.292000</td>\n      <td>446.752000</td>\n      <td>463.675000</td>\n      <td>475.322000</td>\n      <td>484.707000</td>\n      <td>498.413000</td>\n      <td>518.876</td>\n    </tr>\n  </tbody>\n</table>\n<p>15 rows × 36 columns</p>\n</div>\n```\n:::\n:::\n\n\n### 3-25\n\nTable 3-25: Average Wage and Salary Accruals per Full-Time Equivalent Employee by Transportation Industry \\[Source: [Bureau of Transportation Statistics](https://www.bts.gov/content/average-wage-and-salary-accruals-full-time-equivalent-employee-transportation-industry-naics)\\]\n\nFile URL: https://www.bts.gov/sites/bts.dot.gov/files/2022-10/table_03_25_102122.xlsx\n\n::: {#88acdc7e .cell execution_count=4}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_3_25 = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Income-Wage.xlsx\",\n  sheet_name=\"3-25\",\n  header=1,\n  usecols=\"A:X\", # TODO: update cols later for new data\n  nrows=10\n)\n\n# display the data\ndf_3_25\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1998</th>\n      <th>1999</th>\n      <th>2000</th>\n      <th>2001</th>\n      <th>2002</th>\n      <th>2003</th>\n      <th>2004</th>\n      <th>2005</th>\n      <th>2006</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>All industries</td>\n      <td>35509</td>\n      <td>37050</td>\n      <td>39231</td>\n      <td>40213</td>\n      <td>40975</td>\n      <td>42335</td>\n      <td>44263</td>\n      <td>45643</td>\n      <td>47731</td>\n      <td>...</td>\n      <td>54699</td>\n      <td>56089</td>\n      <td>56667</td>\n      <td>58350</td>\n      <td>59993</td>\n      <td>60826</td>\n      <td>62721</td>\n      <td>64685</td>\n      <td>66781</td>\n      <td>71456</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Transportation and warehousing, total</td>\n      <td>35965</td>\n      <td>37426</td>\n      <td>39055</td>\n      <td>39941</td>\n      <td>40690</td>\n      <td>41542</td>\n      <td>43324</td>\n      <td>43939</td>\n      <td>45491</td>\n      <td>...</td>\n      <td>51305</td>\n      <td>52427</td>\n      <td>53364</td>\n      <td>54817</td>\n      <td>55941</td>\n      <td>56593</td>\n      <td>57905</td>\n      <td>59652</td>\n      <td>60647</td>\n      <td>61666</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Air</td>\n      <td>48919</td>\n      <td>50879</td>\n      <td>53231</td>\n      <td>56129</td>\n      <td>58115</td>\n      <td>57596</td>\n      <td>59026</td>\n      <td>56772</td>\n      <td>59290</td>\n      <td>...</td>\n      <td>69400</td>\n      <td>70419</td>\n      <td>77843</td>\n      <td>80317</td>\n      <td>84815</td>\n      <td>92313</td>\n      <td>94909</td>\n      <td>96781</td>\n      <td>98449</td>\n      <td>99954</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Rail</td>\n      <td>59766</td>\n      <td>61287</td>\n      <td>63353</td>\n      <td>64100</td>\n      <td>65120</td>\n      <td>68108</td>\n      <td>72097</td>\n      <td>72903</td>\n      <td>75207</td>\n      <td>...</td>\n      <td>86303</td>\n      <td>92289</td>\n      <td>88364</td>\n      <td>94268</td>\n      <td>95455</td>\n      <td>93446</td>\n      <td>96818</td>\n      <td>103016</td>\n      <td>103306</td>\n      <td>114672</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Water</td>\n      <td>48450</td>\n      <td>50407</td>\n      <td>51516</td>\n      <td>55953</td>\n      <td>56988</td>\n      <td>58202</td>\n      <td>61774</td>\n      <td>62903</td>\n      <td>66463</td>\n      <td>...</td>\n      <td>82480</td>\n      <td>82976</td>\n      <td>84329</td>\n      <td>87942</td>\n      <td>90253</td>\n      <td>89909</td>\n      <td>92209</td>\n      <td>95416</td>\n      <td>96468</td>\n      <td>101096</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Truck</td>\n      <td>33686</td>\n      <td>34864</td>\n      <td>36030</td>\n      <td>36502</td>\n      <td>37315</td>\n      <td>38296</td>\n      <td>40106</td>\n      <td>41481</td>\n      <td>43069</td>\n      <td>...</td>\n      <td>46869</td>\n      <td>47810</td>\n      <td>48831</td>\n      <td>50679</td>\n      <td>52057</td>\n      <td>52676</td>\n      <td>54525</td>\n      <td>57211</td>\n      <td>58338</td>\n      <td>60585</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Transit and ground passenger transportation</td>\n      <td>21840</td>\n      <td>22801</td>\n      <td>23827</td>\n      <td>24335</td>\n      <td>24764</td>\n      <td>25274</td>\n      <td>26725</td>\n      <td>27123</td>\n      <td>28600</td>\n      <td>...</td>\n      <td>32015</td>\n      <td>32553</td>\n      <td>33125</td>\n      <td>34236</td>\n      <td>35413</td>\n      <td>37442</td>\n      <td>40547</td>\n      <td>44520</td>\n      <td>51674</td>\n      <td>49588</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Pipeline</td>\n      <td>64305</td>\n      <td>71789</td>\n      <td>96662</td>\n      <td>100514</td>\n      <td>82058</td>\n      <td>83970</td>\n      <td>89294</td>\n      <td>88952</td>\n      <td>97746</td>\n      <td>...</td>\n      <td>119021</td>\n      <td>137264</td>\n      <td>124309</td>\n      <td>124963</td>\n      <td>129658</td>\n      <td>130880</td>\n      <td>136721</td>\n      <td>137285</td>\n      <td>146037</td>\n      <td>145784</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Other transportation and support activitiesb</td>\n      <td>32605</td>\n      <td>34489</td>\n      <td>35823</td>\n      <td>36173</td>\n      <td>37672</td>\n      <td>39122</td>\n      <td>41429</td>\n      <td>42518</td>\n      <td>44126</td>\n      <td>...</td>\n      <td>49988</td>\n      <td>50800</td>\n      <td>51636</td>\n      <td>52364</td>\n      <td>52882</td>\n      <td>53007</td>\n      <td>53984</td>\n      <td>55216</td>\n      <td>55694</td>\n      <td>57562</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Warehousing and storage</td>\n      <td>31317</td>\n      <td>32307</td>\n      <td>33623</td>\n      <td>34156</td>\n      <td>35164</td>\n      <td>36605</td>\n      <td>37942</td>\n      <td>38861</td>\n      <td>39410</td>\n      <td>...</td>\n      <td>44956</td>\n      <td>45408</td>\n      <td>45603</td>\n      <td>46375</td>\n      <td>46642</td>\n      <td>45893</td>\n      <td>45659</td>\n      <td>46457</td>\n      <td>46818</td>\n      <td>48340</td>\n    </tr>\n  </tbody>\n</table>\n<p>10 rows × 24 columns</p>\n</div>\n```\n:::\n:::\n\n\n### 4-12\n\nTable 4-12: Light Duty Vehicle, Long Wheel Base Fuel Consumption and Travel \\[Source: [Bureau of Transportation Statistics](https://www.bts.gov/content/other-2-axle-4-tire-vehicle-fuel-consumption-and-travel-0)\\]\n\nFile URL: https://www.bts.gov/sites/bts.dot.gov/files/2025-03/table_04_12M_032725.xlsx\n\n::: {#65a07dd3 .cell execution_count=5}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_4_12 = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"4-12\",\n  header=1,\n  usecols=\"A:AI\", # TODO: update cols later for new data\n  nrows=6\n)\n\n# display the data\ndf_4_12\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Number registered (thousands)</td>\n      <td>14210.591000</td>\n      <td>20418.250000</td>\n      <td>27875.934000</td>\n      <td>37213.862554</td>\n      <td>48274.555010</td>\n      <td>53033.443000</td>\n      <td>57091.142829</td>\n      <td>59993.705543</td>\n      <td>57141.967000</td>\n      <td>...</td>\n      <td>40241.657961</td>\n      <td>50318.787311</td>\n      <td>50588.676217</td>\n      <td>51512.739867</td>\n      <td>52600.309315</td>\n      <td>53298.884000</td>\n      <td>54870.473000</td>\n      <td>56880.878000</td>\n      <td>57853.642000</td>\n      <td>59465.369000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Vehicle-miles traveled (millions)</td>\n      <td>123286.000000</td>\n      <td>200700.000000</td>\n      <td>290935.000000</td>\n      <td>390960.594244</td>\n      <td>574570.645532</td>\n      <td>649393.980496</td>\n      <td>706862.759067</td>\n      <td>745749.875553</td>\n      <td>669321.074506</td>\n      <td>...</td>\n      <td>622711.753397</td>\n      <td>604175.473333</td>\n      <td>601231.899220</td>\n      <td>603306.816472</td>\n      <td>638484.173908</td>\n      <td>631852.444733</td>\n      <td>657954.081275</td>\n      <td>656577.526707</td>\n      <td>664495.031255</td>\n      <td>669744.315204</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Fuel consumed (million gallons)</td>\n      <td>12313.439000</td>\n      <td>19080.677699</td>\n      <td>23796.196146</td>\n      <td>27363.169914</td>\n      <td>35611.040835</td>\n      <td>38216.904843</td>\n      <td>40929.421682</td>\n      <td>42851.206705</td>\n      <td>44422.988268</td>\n      <td>...</td>\n      <td>36250.973903</td>\n      <td>35334.618042</td>\n      <td>35114.343892</td>\n      <td>35158.688623</td>\n      <td>37342.987266</td>\n      <td>36437.330269</td>\n      <td>37818.755208</td>\n      <td>37466.749228</td>\n      <td>37189.349730</td>\n      <td>38028.860029</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Average miles traveled per vehicle (thousands)</td>\n      <td>8.675642</td>\n      <td>9.829442</td>\n      <td>10.436780</td>\n      <td>10.505778</td>\n      <td>11.902143</td>\n      <td>12.244990</td>\n      <td>12.381303</td>\n      <td>12.430469</td>\n      <td>11.713301</td>\n      <td>...</td>\n      <td>15.474307</td>\n      <td>12.006956</td>\n      <td>11.884713</td>\n      <td>11.711798</td>\n      <td>12.138411</td>\n      <td>11.854891</td>\n      <td>11.991041</td>\n      <td>11.543027</td>\n      <td>11.485794</td>\n      <td>11.262762</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Average miles traveled per gallon</td>\n      <td>10.012313</td>\n      <td>10.518494</td>\n      <td>12.226114</td>\n      <td>14.287840</td>\n      <td>16.134621</td>\n      <td>16.992323</td>\n      <td>17.270285</td>\n      <td>17.403241</td>\n      <td>15.066998</td>\n      <td>...</td>\n      <td>17.177794</td>\n      <td>17.098684</td>\n      <td>17.122117</td>\n      <td>17.159537</td>\n      <td>17.097833</td>\n      <td>17.340800</td>\n      <td>17.397560</td>\n      <td>17.524273</td>\n      <td>17.867885</td>\n      <td>17.611475</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Average fuel consumed per vehicle (gallons)</td>\n      <td>866.497319</td>\n      <td>934.491335</td>\n      <td>853.646595</td>\n      <td>735.295077</td>\n      <td>737.677247</td>\n      <td>720.618966</td>\n      <td>716.913687</td>\n      <td>714.261710</td>\n      <td>777.414405</td>\n      <td>...</td>\n      <td>900.832017</td>\n      <td>702.215215</td>\n      <td>694.114702</td>\n      <td>682.524143</td>\n      <td>709.938549</td>\n      <td>683.641524</td>\n      <td>689.236909</td>\n      <td>658.687955</td>\n      <td>642.817780</td>\n      <td>639.512723</td>\n    </tr>\n  </tbody>\n</table>\n<p>6 rows × 35 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy - CombinedVehType\n\nTable 4-9:  Motor Vehicle Fuel Consumption and Travel \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#4c382c86 .cell execution_count=6}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_FE_CombinedVehType = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"CombinedVehType\",\n  header=1,\n  usecols=\"A:AK\", # TODO: update cols later for new data\n  nrows=6\n)\n\n# display the data\ndf_FE_CombinedVehType\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1960</th>\n      <th>1965</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Vehicles registered (thousands)</td>\n      <td>73857.768000</td>\n      <td>90357.667000</td>\n      <td>1.112423e+05</td>\n      <td>1.379128e+05</td>\n      <td>1.614902e+05</td>\n      <td>1.771333e+05</td>\n      <td>1.930574e+05</td>\n      <td>1.923138e+05</td>\n      <td>1.944273e+05</td>\n      <td>...</td>\n      <td>2.500700e+05</td>\n      <td>2.532157e+05</td>\n      <td>2.536394e+05</td>\n      <td>2.558768e+05</td>\n      <td>2.603509e+05</td>\n      <td>2.636102e+05</td>\n      <td>2.687991e+05</td>\n      <td>2.724809e+05</td>\n      <td>2.736021e+05</td>\n      <td>2.764912e+05</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Vehicle-miles traveled (millions)</td>\n      <td>718762.000000</td>\n      <td>887812.000000</td>\n      <td>1.109724e+06</td>\n      <td>1.327664e+06</td>\n      <td>1.527295e+06</td>\n      <td>1.774826e+06</td>\n      <td>2.144362e+06</td>\n      <td>2.172050e+06</td>\n      <td>2.247151e+06</td>\n      <td>...</td>\n      <td>2.967266e+06</td>\n      <td>2.950402e+06</td>\n      <td>2.969433e+06</td>\n      <td>2.988280e+06</td>\n      <td>3.025656e+06</td>\n      <td>3.095373e+06</td>\n      <td>3.174408e+06</td>\n      <td>3.212347e+06</td>\n      <td>3.240327e+06</td>\n      <td>3.261772e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Fuel consumed (million gallons)</td>\n      <td>57879.908000</td>\n      <td>71104.000000</td>\n      <td>9.232906e+04</td>\n      <td>1.089843e+05</td>\n      <td>1.149599e+05</td>\n      <td>1.213013e+05</td>\n      <td>1.307551e+05</td>\n      <td>1.285630e+05</td>\n      <td>1.328876e+05</td>\n      <td>...</td>\n      <td>1.704106e+05</td>\n      <td>1.684523e+05</td>\n      <td>1.686205e+05</td>\n      <td>1.696510e+05</td>\n      <td>1.733471e+05</td>\n      <td>1.728810e+05</td>\n      <td>1.768913e+05</td>\n      <td>1.779511e+05</td>\n      <td>1.781303e+05</td>\n      <td>1.799910e+05</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Average miles traveled per vehicle (thousands)</td>\n      <td>9.731705</td>\n      <td>9.825530</td>\n      <td>9.975738e+00</td>\n      <td>9.626838e+00</td>\n      <td>9.457511e+00</td>\n      <td>1.001972e+01</td>\n      <td>1.110738e+01</td>\n      <td>1.129430e+01</td>\n      <td>1.155779e+01</td>\n      <td>...</td>\n      <td>1.186574e+01</td>\n      <td>1.165173e+01</td>\n      <td>1.170730e+01</td>\n      <td>1.167859e+01</td>\n      <td>1.162145e+01</td>\n      <td>1.174223e+01</td>\n      <td>1.180959e+01</td>\n      <td>1.178926e+01</td>\n      <td>1.184321e+01</td>\n      <td>1.179702e+01</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Average miles traveled per gallon</td>\n      <td>12.418161</td>\n      <td>12.486105</td>\n      <td>1.201923e+01</td>\n      <td>1.218215e+01</td>\n      <td>1.328546e+01</td>\n      <td>1.463155e+01</td>\n      <td>1.639983e+01</td>\n      <td>1.689483e+01</td>\n      <td>1.691017e+01</td>\n      <td>...</td>\n      <td>1.741245e+01</td>\n      <td>1.751476e+01</td>\n      <td>1.761015e+01</td>\n      <td>1.761428e+01</td>\n      <td>1.745432e+01</td>\n      <td>1.790465e+01</td>\n      <td>1.794553e+01</td>\n      <td>1.805186e+01</td>\n      <td>1.819076e+01</td>\n      <td>1.812186e+01</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Average fuel consumed per vehicle (gallons)</td>\n      <td>783.667170</td>\n      <td>786.917174</td>\n      <td>8.299816e+02</td>\n      <td>7.902411e+02</td>\n      <td>7.118691e+02</td>\n      <td>6.848024e+02</td>\n      <td>6.772865e+02</td>\n      <td>6.685064e+02</td>\n      <td>6.834818e+02</td>\n      <td>...</td>\n      <td>6.814513e+02</td>\n      <td>6.652522e+02</td>\n      <td>6.648042e+02</td>\n      <td>6.630181e+02</td>\n      <td>6.658211e+02</td>\n      <td>6.558204e+02</td>\n      <td>6.580799e+02</td>\n      <td>6.530773e+02</td>\n      <td>6.510562e+02</td>\n      <td>6.509826e+02</td>\n    </tr>\n  </tbody>\n</table>\n<p>6 rows × 37 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy - LightDuty\n\nTable 4-23:  Average Fuel Efficiency of U.S. Light Duty Vehicles \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#87c56304 .cell execution_count=7}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_FE_LightDuty = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"LightDuty\",\n  header=1,\n  usecols=\"A:AG\", # TODO: update cols later for new data\n  nrows=12\n)\n\n# display the data\ndf_FE_LightDuty\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>1995</th>\n      <th>1996</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Average U.S. light duty vehicle fuel efficienc...</td>\n      <td>14.9</td>\n      <td>16.500000</td>\n      <td>18.800000</td>\n      <td>19.500000</td>\n      <td>19.500000</td>\n      <td>19.200000</td>\n      <td>19.391913</td>\n      <td>19.602243</td>\n      <td>19.691458</td>\n      <td>...</td>\n      <td>21.525254</td>\n      <td>21.367594</td>\n      <td>21.550948</td>\n      <td>21.634777</td>\n      <td>21.402991</td>\n      <td>21.979313</td>\n      <td>22.038465</td>\n      <td>22.274363</td>\n      <td>22.497301</td>\n      <td>22.244734</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Light duty vehicle, short wheel basea,b</td>\n      <td>15.983485</td>\n      <td>17.515866</td>\n      <td>20.324466</td>\n      <td>21.199052</td>\n      <td>21.045126</td>\n      <td>20.590441</td>\n      <td>22.237518</td>\n      <td>21.128875</td>\n      <td>21.319621</td>\n      <td>...</td>\n      <td>23.341159</td>\n      <td>23.079824</td>\n      <td>23.303850</td>\n      <td>23.410444</td>\n      <td>23.203282</td>\n      <td>23.856606</td>\n      <td>23.956898</td>\n      <td>24.214896</td>\n      <td>24.377132</td>\n      <td>24.130806</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Light duty vehicle, long wheel basea</td>\n      <td>12.226114</td>\n      <td>14.287840</td>\n      <td>16.134621</td>\n      <td>16.992323</td>\n      <td>17.270285</td>\n      <td>17.403241</td>\n      <td>15.066998</td>\n      <td>17.323486</td>\n      <td>17.311470</td>\n      <td>...</td>\n      <td>17.177794</td>\n      <td>17.076254</td>\n      <td>17.128316</td>\n      <td>17.159537</td>\n      <td>17.097833</td>\n      <td>17.340800</td>\n      <td>17.397560</td>\n      <td>17.524273</td>\n      <td>17.867885</td>\n      <td>17.611475</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>New vehicle fuel efficiency (mpg)c (model year)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Light-duty vehicle</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Passenger car</td>\n      <td>24.3</td>\n      <td>27.600000</td>\n      <td>28.000000</td>\n      <td>28.400000</td>\n      <td>27.900000</td>\n      <td>28.400000</td>\n      <td>28.300000</td>\n      <td>28.600000</td>\n      <td>28.500000</td>\n      <td>...</td>\n      <td>33.937919</td>\n      <td>33.126479</td>\n      <td>35.270757</td>\n      <td>36.399878</td>\n      <td>36.537293</td>\n      <td>37.243193</td>\n      <td>37.657829</td>\n      <td>39.441726</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Domestic</td>\n      <td>22.6</td>\n      <td>26.300000</td>\n      <td>26.900000</td>\n      <td>27.300000</td>\n      <td>27.000000</td>\n      <td>27.800000</td>\n      <td>27.500000</td>\n      <td>27.700000</td>\n      <td>28.100000</td>\n      <td>...</td>\n      <td>33.100000</td>\n      <td>32.700000</td>\n      <td>34.800000</td>\n      <td>36.100000</td>\n      <td>36.300000</td>\n      <td>37.200000</td>\n      <td>37.300000</td>\n      <td>39.200000</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Imported</td>\n      <td>29.6</td>\n      <td>31.500000</td>\n      <td>29.900000</td>\n      <td>30.100000</td>\n      <td>29.200000</td>\n      <td>29.600000</td>\n      <td>29.700000</td>\n      <td>30.300000</td>\n      <td>29.600000</td>\n      <td>...</td>\n      <td>35.200000</td>\n      <td>33.700000</td>\n      <td>36.000000</td>\n      <td>36.800000</td>\n      <td>36.900000</td>\n      <td>37.300000</td>\n      <td>38.100000</td>\n      <td>39.700000</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Light truck (&lt;8,500 lbs GVWR)d</td>\n      <td>18.5</td>\n      <td>20.700000</td>\n      <td>20.800000</td>\n      <td>21.300000</td>\n      <td>20.800000</td>\n      <td>21.000000</td>\n      <td>20.800000</td>\n      <td>20.500000</td>\n      <td>20.800000</td>\n      <td>...</td>\n      <td>25.200000</td>\n      <td>24.700000</td>\n      <td>25.000000</td>\n      <td>25.700000</td>\n      <td>26.500000</td>\n      <td>27.300000</td>\n      <td>27.400000</td>\n      <td>28.600000</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>CAFE standards (mpg)c (model year)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Passenger car</td>\n      <td>20</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>27.500000</td>\n      <td>...</td>\n      <td>27.500000</td>\n      <td>30.170592</td>\n      <td>32.974608</td>\n      <td>33.499878</td>\n      <td>34.237293</td>\n      <td>35.459155</td>\n      <td>36.902557</td>\n      <td>39.031797</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Light trucke</td>\n      <td>U</td>\n      <td>19.500000</td>\n      <td>20.000000</td>\n      <td>20.200000</td>\n      <td>20.200000</td>\n      <td>20.400000</td>\n      <td>20.500000</td>\n      <td>20.600000</td>\n      <td>20.700000</td>\n      <td>...</td>\n      <td>23.400000</td>\n      <td>24.300000</td>\n      <td>25.300000</td>\n      <td>25.900000</td>\n      <td>26.300000</td>\n      <td>27.600000</td>\n      <td>28.800000</td>\n      <td>29.400000</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n  </tbody>\n</table>\n<p>12 rows × 33 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Personal Expenditure\n\nTable 3-15: Personal Expenditures by Category (Millions of current dollars) \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#37f6be6a .cell execution_count=8}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_PersonalExpenditure = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Auto Cost & Gas Price.xlsx\",\n  sheet_name=\"3-15\",\n  header=1,\n  usecols=\"A:AL\", # TODO: update cols later for new data\n  nrows=17\n)\n\n# display the data\ndf_PersonalExpenditure\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1960</th>\n      <th>1965</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Total expenditures</td>\n      <td>331180.000000</td>\n      <td>442973.000000</td>\n      <td>646724.000000</td>\n      <td>1.030547e+06</td>\n      <td>1.750667e+06</td>\n      <td>2.712830e+06</td>\n      <td>3.808994e+06</td>\n      <td>3.943449e+06</td>\n      <td>4.197559e+06</td>\n      <td>...</td>\n      <td>1.069886e+07</td>\n      <td>1.104736e+07</td>\n      <td>1.136353e+07</td>\n      <td>1.184772e+07</td>\n      <td>1.226348e+07</td>\n      <td>1.269327e+07</td>\n      <td>1.323911e+07</td>\n      <td>1.391353e+07</td>\n      <td>1.442868e+07</td>\n      <td>1.404756e+07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Transportation</td>\n      <td>40765.000000</td>\n      <td>56529.000000</td>\n      <td>76503.000000</td>\n      <td>1.243900e+05</td>\n      <td>2.264860e+05</td>\n      <td>3.574150e+05</td>\n      <td>4.429310e+05</td>\n      <td>4.182740e+05</td>\n      <td>4.512850e+05</td>\n      <td>...</td>\n      <td>1.080327e+06</td>\n      <td>1.135467e+06</td>\n      <td>1.170466e+06</td>\n      <td>1.202035e+06</td>\n      <td>1.163708e+06</td>\n      <td>1.163149e+06</td>\n      <td>1.233247e+06</td>\n      <td>1.317273e+06</td>\n      <td>1.326530e+06</td>\n      <td>1.133446e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Transportation as a percent of total expenditures</td>\n      <td>12.309016</td>\n      <td>12.761274</td>\n      <td>11.829312</td>\n      <td>1.207029e+01</td>\n      <td>1.293713e+01</td>\n      <td>1.317499e+01</td>\n      <td>1.162856e+01</td>\n      <td>1.060681e+01</td>\n      <td>1.075113e+01</td>\n      <td>...</td>\n      <td>1.009759e+01</td>\n      <td>1.027817e+01</td>\n      <td>1.030020e+01</td>\n      <td>1.014570e+01</td>\n      <td>9.489218e+00</td>\n      <td>9.163512e+00</td>\n      <td>9.315180e+00</td>\n      <td>9.467568e+00</td>\n      <td>9.193706e+00</td>\n      <td>8.068630e+00</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Food and beveragea</td>\n      <td>83040.000000</td>\n      <td>101623.000000</td>\n      <td>145130.000000</td>\n      <td>2.253870e+05</td>\n      <td>3.608880e+05</td>\n      <td>4.772520e+05</td>\n      <td>6.539110e+05</td>\n      <td>6.763480e+05</td>\n      <td>6.907760e+05</td>\n      <td>...</td>\n      <td>1.489007e+06</td>\n      <td>1.551126e+06</td>\n      <td>1.596245e+06</td>\n      <td>1.673789e+06</td>\n      <td>1.753823e+06</td>\n      <td>1.813845e+06</td>\n      <td>1.886616e+06</td>\n      <td>1.961150e+06</td>\n      <td>2.039181e+06</td>\n      <td>1.948223e+06</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Clothing and footwear</td>\n      <td>29263.000000</td>\n      <td>36483.000000</td>\n      <td>49945.000000</td>\n      <td>7.143300e+04</td>\n      <td>1.088340e+05</td>\n      <td>1.543090e+05</td>\n      <td>2.065340e+05</td>\n      <td>2.101160e+05</td>\n      <td>2.230240e+05</td>\n      <td>...</td>\n      <td>3.471140e+05</td>\n      <td>3.595250e+05</td>\n      <td>3.652830e+05</td>\n      <td>3.759990e+05</td>\n      <td>3.840570e+05</td>\n      <td>3.912510e+05</td>\n      <td>3.969850e+05</td>\n      <td>4.083860e+05</td>\n      <td>4.148620e+05</td>\n      <td>3.769760e+05</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Communication</td>\n      <td>5206.000000</td>\n      <td>7535.000000</td>\n      <td>11606.000000</td>\n      <td>1.995500e+04</td>\n      <td>3.179600e+04</td>\n      <td>5.310400e+04</td>\n      <td>7.009300e+04</td>\n      <td>7.387000e+04</td>\n      <td>8.114200e+04</td>\n      <td>...</td>\n      <td>2.280820e+05</td>\n      <td>2.324600e+05</td>\n      <td>2.374830e+05</td>\n      <td>2.539590e+05</td>\n      <td>2.598490e+05</td>\n      <td>2.680850e+05</td>\n      <td>2.663710e+05</td>\n      <td>2.733060e+05</td>\n      <td>2.766960e+05</td>\n      <td>2.744810e+05</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Final consumption expenditures of nonprofit in...</td>\n      <td>5059.000000</td>\n      <td>6962.000000</td>\n      <td>10473.000000</td>\n      <td>1.701300e+04</td>\n      <td>3.003300e+04</td>\n      <td>4.790700e+04</td>\n      <td>7.586000e+04</td>\n      <td>8.012700e+04</td>\n      <td>8.793500e+04</td>\n      <td>...</td>\n      <td>3.118560e+05</td>\n      <td>3.415460e+05</td>\n      <td>3.525900e+05</td>\n      <td>3.655960e+05</td>\n      <td>3.715840e+05</td>\n      <td>4.014330e+05</td>\n      <td>4.179470e+05</td>\n      <td>4.446650e+05</td>\n      <td>4.398900e+05</td>\n      <td>5.208760e+05</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Health</td>\n      <td>20363.000000</td>\n      <td>31977.000000</td>\n      <td>56849.000000</td>\n      <td>1.027170e+05</td>\n      <td>1.954730e+05</td>\n      <td>3.453230e+05</td>\n      <td>5.837240e+05</td>\n      <td>6.383740e+05</td>\n      <td>7.004430e+05</td>\n      <td>...</td>\n      <td>2.153221e+06</td>\n      <td>2.230720e+06</td>\n      <td>2.288266e+06</td>\n      <td>2.409121e+06</td>\n      <td>2.564801e+06</td>\n      <td>2.690123e+06</td>\n      <td>2.795969e+06</td>\n      <td>2.919476e+06</td>\n      <td>3.073873e+06</td>\n      <td>2.954135e+06</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Household operationb</td>\n      <td>26179.000000</td>\n      <td>34706.000000</td>\n      <td>46617.000000</td>\n      <td>6.780500e+04</td>\n      <td>1.107370e+05</td>\n      <td>1.559930e+05</td>\n      <td>2.005590e+05</td>\n      <td>1.991090e+05</td>\n      <td>2.093990e+05</td>\n      <td>...</td>\n      <td>4.236660e+05</td>\n      <td>4.385710e+05</td>\n      <td>4.542900e+05</td>\n      <td>4.765800e+05</td>\n      <td>5.001270e+05</td>\n      <td>5.191250e+05</td>\n      <td>5.401940e+05</td>\n      <td>5.757180e+05</td>\n      <td>6.012440e+05</td>\n      <td>6.452160e+05</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Housing, utilities, and fuels</td>\n      <td>60525.000000</td>\n      <td>80999.000000</td>\n      <td>113786.000000</td>\n      <td>1.848430e+05</td>\n      <td>3.276620e+05</td>\n      <td>5.139370e+05</td>\n      <td>7.092990e+05</td>\n      <td>7.475250e+05</td>\n      <td>7.832550e+05</td>\n      <td>...</td>\n      <td>2.010292e+06</td>\n      <td>2.038866e+06</td>\n      <td>2.108721e+06</td>\n      <td>2.177735e+06</td>\n      <td>2.226392e+06</td>\n      <td>2.297365e+06</td>\n      <td>2.382083e+06</td>\n      <td>2.494067e+06</td>\n      <td>2.592457e+06</td>\n      <td>2.686161e+06</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Financial services and insurance</td>\n      <td>13155.000000</td>\n      <td>18788.000000</td>\n      <td>30107.000000</td>\n      <td>5.181200e+04</td>\n      <td>9.165900e+04</td>\n      <td>1.782470e+05</td>\n      <td>2.307570e+05</td>\n      <td>2.500830e+05</td>\n      <td>2.769950e+05</td>\n      <td>...</td>\n      <td>8.110640e+05</td>\n      <td>8.309230e+05</td>\n      <td>8.693090e+05</td>\n      <td>9.229410e+05</td>\n      <td>9.744300e+05</td>\n      <td>9.961390e+05</td>\n      <td>1.068958e+06</td>\n      <td>1.151901e+06</td>\n      <td>1.171585e+06</td>\n      <td>1.196283e+06</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Recreation</td>\n      <td>19711.000000</td>\n      <td>28891.000000</td>\n      <td>47017.000000</td>\n      <td>7.705300e+04</td>\n      <td>1.274400e+05</td>\n      <td>2.071630e+05</td>\n      <td>3.147460e+05</td>\n      <td>3.262720e+05</td>\n      <td>3.468410e+05</td>\n      <td>...</td>\n      <td>9.016210e+05</td>\n      <td>9.344090e+05</td>\n      <td>9.674430e+05</td>\n      <td>1.004537e+06</td>\n      <td>1.045575e+06</td>\n      <td>1.094142e+06</td>\n      <td>1.143640e+06</td>\n      <td>1.200142e+06</td>\n      <td>1.261520e+06</td>\n      <td>1.176858e+06</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Education</td>\n      <td>3360.000000</td>\n      <td>5465.000000</td>\n      <td>9914.000000</td>\n      <td>1.588600e+04</td>\n      <td>2.544300e+04</td>\n      <td>4.117200e+04</td>\n      <td>6.595800e+04</td>\n      <td>7.056100e+04</td>\n      <td>7.644200e+04</td>\n      <td>...</td>\n      <td>2.482060e+05</td>\n      <td>2.505890e+05</td>\n      <td>2.566530e+05</td>\n      <td>2.633240e+05</td>\n      <td>2.719040e+05</td>\n      <td>2.817010e+05</td>\n      <td>2.887740e+05</td>\n      <td>2.979150e+05</td>\n      <td>3.083510e+05</td>\n      <td>2.931500e+05</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Foreign travel, net</td>\n      <td>2121.000000</td>\n      <td>2858.000000</td>\n      <td>4514.000000</td>\n      <td>4.445000e+03</td>\n      <td>3.540000e+03</td>\n      <td>7.741000e+03</td>\n      <td>-7.673000e+03</td>\n      <td>-1.521900e+04</td>\n      <td>-2.003400e+04</td>\n      <td>...</td>\n      <td>-1.769600e+04</td>\n      <td>-2.221000e+04</td>\n      <td>-4.327200e+04</td>\n      <td>-4.412700e+04</td>\n      <td>-5.071600e+04</td>\n      <td>-4.519200e+04</td>\n      <td>-3.720300e+04</td>\n      <td>-2.168300e+04</td>\n      <td>-4.526000e+03</td>\n      <td>-9.505000e+03</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Other</td>\n      <td>22433.000000</td>\n      <td>30157.000000</td>\n      <td>44263.000000</td>\n      <td>6.780800e+04</td>\n      <td>1.106750e+05</td>\n      <td>1.732670e+05</td>\n      <td>2.622970e+05</td>\n      <td>2.680090e+05</td>\n      <td>2.900550e+05</td>\n      <td>...</td>\n      <td>7.120960e+05</td>\n      <td>7.253700e+05</td>\n      <td>7.400500e+05</td>\n      <td>7.662350e+05</td>\n      <td>7.979410e+05</td>\n      <td>8.221010e+05</td>\n      <td>8.555290e+05</td>\n      <td>8.912160e+05</td>\n      <td>9.270130e+05</td>\n      <td>8.512650e+05</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Disposable Personal Income (DPI)</td>\n      <td>376070.000000</td>\n      <td>512995.000000</td>\n      <td>761975.000000</td>\n      <td>1.221782e+06</td>\n      <td>2.024133e+06</td>\n      <td>3.107068e+06</td>\n      <td>4.319123e+06</td>\n      <td>4.496012e+06</td>\n      <td>4.808066e+06</td>\n      <td>...</td>\n      <td>1.188560e+07</td>\n      <td>1.250482e+07</td>\n      <td>1.251726e+07</td>\n      <td>1.319199e+07</td>\n      <td>1.374528e+07</td>\n      <td>1.413867e+07</td>\n      <td>1.480120e+07</td>\n      <td>1.562971e+07</td>\n      <td>1.621926e+07</td>\n      <td>1.743203e+07</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Transportation as a percent of DPI</td>\n      <td>10.839737</td>\n      <td>11.019406</td>\n      <td>10.040093</td>\n      <td>1.018103e+01</td>\n      <td>1.118928e+01</td>\n      <td>1.150329e+01</td>\n      <td>1.025511e+01</td>\n      <td>9.303223e+00</td>\n      <td>9.385998e+00</td>\n      <td>...</td>\n      <td>9.089377e+00</td>\n      <td>9.080231e+00</td>\n      <td>9.350813e+00</td>\n      <td>9.111854e+00</td>\n      <td>8.466237e+00</td>\n      <td>8.226722e+00</td>\n      <td>8.332076e+00</td>\n      <td>8.428007e+00</td>\n      <td>8.178733e+00</td>\n      <td>6.502090e+00</td>\n    </tr>\n  </tbody>\n</table>\n<p>17 rows × 38 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Personal Consumption\n\nTable 3-16: Personal Consumption Expenditures on Transportation by Subcategory (Millions of current dollars) \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#c017ba34 .cell execution_count=9}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_PersonalConsumption = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Auto Cost & Gas Price.xlsx\",\n  sheet_name=\"3-16\",\n  header=1,\n  usecols=\"A:AL\", # TODO: update cols later for new data\n  nrows=17\n)\n\n# display the data\ndf_PersonalConsumption\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1960</th>\n      <th>1965</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>TOTAL transportation</td>\n      <td>40765</td>\n      <td>56529</td>\n      <td>76503</td>\n      <td>124390</td>\n      <td>226486</td>\n      <td>357415</td>\n      <td>442931</td>\n      <td>418274</td>\n      <td>451285</td>\n      <td>...</td>\n      <td>1080327</td>\n      <td>1135467</td>\n      <td>1170466</td>\n      <td>1202035</td>\n      <td>1163708</td>\n      <td>1163149</td>\n      <td>1233247</td>\n      <td>1317273</td>\n      <td>1326530</td>\n      <td>1133446</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>User-operated transportation, total</td>\n      <td>39510</td>\n      <td>55325</td>\n      <td>74483</td>\n      <td>121054</td>\n      <td>218784</td>\n      <td>349065</td>\n      <td>433278</td>\n      <td>409458</td>\n      <td>444552</td>\n      <td>...</td>\n      <td>1035364</td>\n      <td>1087085</td>\n      <td>1117565</td>\n      <td>1146119</td>\n      <td>1108395</td>\n      <td>1109942</td>\n      <td>1175934</td>\n      <td>1250258</td>\n      <td>1251856</td>\n      <td>1166254</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>New cars and net purchases of used cars</td>\n      <td>16571</td>\n      <td>25191</td>\n      <td>26754</td>\n      <td>36775</td>\n      <td>57243</td>\n      <td>110679</td>\n      <td>118988</td>\n      <td>103658</td>\n      <td>112410</td>\n      <td>...</td>\n      <td>125483</td>\n      <td>139063</td>\n      <td>142334</td>\n      <td>143986</td>\n      <td>144678</td>\n      <td>137417</td>\n      <td>129250</td>\n      <td>119477</td>\n      <td>101261</td>\n      <td>84689</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>New and used trucks and RVs</td>\n      <td>606</td>\n      <td>1284</td>\n      <td>2667</td>\n      <td>7739</td>\n      <td>11849</td>\n      <td>40988</td>\n      <td>63882</td>\n      <td>60337</td>\n      <td>70115</td>\n      <td>...</td>\n      <td>190904</td>\n      <td>207711</td>\n      <td>225517</td>\n      <td>248602</td>\n      <td>279991</td>\n      <td>296716</td>\n      <td>323258</td>\n      <td>351435</td>\n      <td>362168</td>\n      <td>407737</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Motor vehicle parts and accessories</td>\n      <td>2487</td>\n      <td>3450</td>\n      <td>6087</td>\n      <td>10287</td>\n      <td>17926</td>\n      <td>23483</td>\n      <td>28254</td>\n      <td>27803</td>\n      <td>28727</td>\n      <td>...</td>\n      <td>60733</td>\n      <td>63306</td>\n      <td>65483</td>\n      <td>66821</td>\n      <td>69846</td>\n      <td>71667</td>\n      <td>73499</td>\n      <td>75488</td>\n      <td>77854</td>\n      <td>80449</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Repair and rentala</td>\n      <td>5262</td>\n      <td>7214</td>\n      <td>11776</td>\n      <td>18971</td>\n      <td>32597</td>\n      <td>58035</td>\n      <td>82033</td>\n      <td>78832</td>\n      <td>86705</td>\n      <td>...</td>\n      <td>191898</td>\n      <td>198857</td>\n      <td>208242</td>\n      <td>222249</td>\n      <td>232741</td>\n      <td>249976</td>\n      <td>260974</td>\n      <td>272115</td>\n      <td>284233</td>\n      <td>265126</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Gasoline and oil</td>\n      <td>12004</td>\n      <td>14751</td>\n      <td>21921</td>\n      <td>39703</td>\n      <td>86689</td>\n      <td>97205</td>\n      <td>111440</td>\n      <td>108852</td>\n      <td>112864</td>\n      <td>...</td>\n      <td>386787</td>\n      <td>397808</td>\n      <td>392996</td>\n      <td>377002</td>\n      <td>289690</td>\n      <td>259154</td>\n      <td>291022</td>\n      <td>328430</td>\n      <td>316670</td>\n      <td>228740</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Parking fees and tolls</td>\n      <td>567</td>\n      <td>816</td>\n      <td>1205</td>\n      <td>1652</td>\n      <td>2529</td>\n      <td>4004</td>\n      <td>5171</td>\n      <td>5546</td>\n      <td>6427</td>\n      <td>...</td>\n      <td>17797</td>\n      <td>18616</td>\n      <td>19971</td>\n      <td>21481</td>\n      <td>23204</td>\n      <td>23926</td>\n      <td>24953</td>\n      <td>25694</td>\n      <td>26659</td>\n      <td>17146</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Insurance premiums, less claims paidb</td>\n      <td>2013</td>\n      <td>2619</td>\n      <td>4073</td>\n      <td>5927</td>\n      <td>9951</td>\n      <td>14671</td>\n      <td>23510</td>\n      <td>24430</td>\n      <td>27304</td>\n      <td>...</td>\n      <td>61762</td>\n      <td>61724</td>\n      <td>63022</td>\n      <td>65978</td>\n      <td>68245</td>\n      <td>71086</td>\n      <td>72978</td>\n      <td>77619</td>\n      <td>83011</td>\n      <td>82367</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Purchased intercity transportation, total</td>\n      <td>1447</td>\n      <td>2145</td>\n      <td>4156</td>\n      <td>7402</td>\n      <td>15376</td>\n      <td>21014</td>\n      <td>29468</td>\n      <td>28827</td>\n      <td>29338</td>\n      <td>...</td>\n      <td>95751</td>\n      <td>100109</td>\n      <td>106391</td>\n      <td>112037</td>\n      <td>113811</td>\n      <td>115954</td>\n      <td>123494</td>\n      <td>136167</td>\n      <td>150094</td>\n      <td>65075</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Railroad</td>\n      <td>448</td>\n      <td>429</td>\n      <td>395</td>\n      <td>474</td>\n      <td>588</td>\n      <td>616</td>\n      <td>696</td>\n      <td>697</td>\n      <td>546</td>\n      <td>...</td>\n      <td>1085</td>\n      <td>1152</td>\n      <td>1210</td>\n      <td>1250</td>\n      <td>1227</td>\n      <td>1241</td>\n      <td>1286</td>\n      <td>1285</td>\n      <td>1348</td>\n      <td>407</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Intercity bus</td>\n      <td>154</td>\n      <td>206</td>\n      <td>311</td>\n      <td>455</td>\n      <td>873</td>\n      <td>754</td>\n      <td>615</td>\n      <td>674</td>\n      <td>682</td>\n      <td>...</td>\n      <td>1146</td>\n      <td>1128</td>\n      <td>1149</td>\n      <td>1167</td>\n      <td>1130</td>\n      <td>1227</td>\n      <td>1329</td>\n      <td>1324</td>\n      <td>1322</td>\n      <td>802</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Airline</td>\n      <td>678</td>\n      <td>1279</td>\n      <td>3075</td>\n      <td>5890</td>\n      <td>12768</td>\n      <td>18088</td>\n      <td>25891</td>\n      <td>25069</td>\n      <td>25581</td>\n      <td>...</td>\n      <td>78636</td>\n      <td>82102</td>\n      <td>87210</td>\n      <td>91545</td>\n      <td>91757</td>\n      <td>92418</td>\n      <td>97851</td>\n      <td>107670</td>\n      <td>120355</td>\n      <td>49649</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Otherc</td>\n      <td>167</td>\n      <td>231</td>\n      <td>375</td>\n      <td>583</td>\n      <td>1147</td>\n      <td>1556</td>\n      <td>2266</td>\n      <td>2387</td>\n      <td>2529</td>\n      <td>...</td>\n      <td>14884</td>\n      <td>15727</td>\n      <td>16822</td>\n      <td>18075</td>\n      <td>19697</td>\n      <td>21068</td>\n      <td>23028</td>\n      <td>25888</td>\n      <td>27069</td>\n      <td>14217</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Purchased local transportation, total</td>\n      <td>1904</td>\n      <td>1958</td>\n      <td>2906</td>\n      <td>4019</td>\n      <td>4864</td>\n      <td>7093</td>\n      <td>9701</td>\n      <td>10468</td>\n      <td>11153</td>\n      <td>...</td>\n      <td>22918</td>\n      <td>23469</td>\n      <td>25333</td>\n      <td>27275</td>\n      <td>28914</td>\n      <td>29820</td>\n      <td>31457</td>\n      <td>35399</td>\n      <td>34327</td>\n      <td>16094</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Mass transit system</td>\n      <td>1295</td>\n      <td>1346</td>\n      <td>1726</td>\n      <td>2051</td>\n      <td>2998</td>\n      <td>4521</td>\n      <td>7124</td>\n      <td>7843</td>\n      <td>8567</td>\n      <td>...</td>\n      <td>17534</td>\n      <td>18095</td>\n      <td>19076</td>\n      <td>19732</td>\n      <td>20233</td>\n      <td>20507</td>\n      <td>20675</td>\n      <td>20926</td>\n      <td>21302</td>\n      <td>8568</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Taxi</td>\n      <td>609</td>\n      <td>612</td>\n      <td>1180</td>\n      <td>1968</td>\n      <td>1866</td>\n      <td>2572</td>\n      <td>2577</td>\n      <td>2625</td>\n      <td>2586</td>\n      <td>...</td>\n      <td>5384</td>\n      <td>5374</td>\n      <td>6257</td>\n      <td>7543</td>\n      <td>8681</td>\n      <td>9313</td>\n      <td>10782</td>\n      <td>14473</td>\n      <td>13025</td>\n      <td>7526</td>\n    </tr>\n  </tbody>\n</table>\n<p>17 rows × 38 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Consumer Price Index\n\nData Source:\n\n::: {#66a90a70 .cell execution_count=10}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_CPI = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"CPI\",\n  header=5,\n  usecols=\"B:Q\", # TODO: update cols later for new data\n  nrows=131\n)\n\n# Remove rows where all elements are NaN (empty)\ndf_CPI = df_CPI.dropna(how='all')\n\n# display the data\ndf_CPI\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Jan.</th>\n      <th>Feb.</th>\n      <th>Mar.</th>\n      <th>Apr.</th>\n      <th>May</th>\n      <th>June</th>\n      <th>July</th>\n      <th>Aug.</th>\n      <th>Sep.</th>\n      <th>Oct.</th>\n      <th>Nov.</th>\n      <th>Dec.</th>\n      <th>Avg.</th>\n      <th>Dec</th>\n      <th>Avg</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>1913.0</td>\n      <td>9.800</td>\n      <td>9.800</td>\n      <td>9.800</td>\n      <td>9.800</td>\n      <td>9.700</td>\n      <td>9.800</td>\n      <td>9.900</td>\n      <td>9.900</td>\n      <td>10.000</td>\n      <td>10.000</td>\n      <td>10.100</td>\n      <td>10.000</td>\n      <td>9.900</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1914.0</td>\n      <td>10.000</td>\n      <td>9.900</td>\n      <td>9.900</td>\n      <td>9.800</td>\n      <td>9.900</td>\n      <td>9.900</td>\n      <td>10.000</td>\n      <td>10.200</td>\n      <td>10.200</td>\n      <td>10.100</td>\n      <td>10.200</td>\n      <td>10.100</td>\n      <td>10.000</td>\n      <td>1.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1915.0</td>\n      <td>10.100</td>\n      <td>10.000</td>\n      <td>9.900</td>\n      <td>10.000</td>\n      <td>10.100</td>\n      <td>10.100</td>\n      <td>10.100</td>\n      <td>10.100</td>\n      <td>10.100</td>\n      <td>10.200</td>\n      <td>10.300</td>\n      <td>10.300</td>\n      <td>10.100</td>\n      <td>2.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1916.0</td>\n      <td>10.400</td>\n      <td>10.400</td>\n      <td>10.500</td>\n      <td>10.600</td>\n      <td>10.700</td>\n      <td>10.800</td>\n      <td>10.800</td>\n      <td>10.900</td>\n      <td>11.100</td>\n      <td>11.300</td>\n      <td>11.500</td>\n      <td>11.600</td>\n      <td>10.900</td>\n      <td>12.6</td>\n      <td>7.9</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1917.0</td>\n      <td>11.700</td>\n      <td>12.000</td>\n      <td>12.000</td>\n      <td>12.600</td>\n      <td>12.800</td>\n      <td>13.000</td>\n      <td>12.800</td>\n      <td>13.000</td>\n      <td>13.300</td>\n      <td>13.500</td>\n      <td>13.500</td>\n      <td>13.700</td>\n      <td>12.800</td>\n      <td>18.1</td>\n      <td>17.4</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>2016.0</td>\n      <td>236.916</td>\n      <td>237.111</td>\n      <td>238.132</td>\n      <td>239.261</td>\n      <td>240.229</td>\n      <td>241.018</td>\n      <td>240.628</td>\n      <td>240.849</td>\n      <td>241.428</td>\n      <td>241.729</td>\n      <td>241.353</td>\n      <td>241.432</td>\n      <td>240.007</td>\n      <td>2.1</td>\n      <td>1.3</td>\n    </tr>\n    <tr>\n      <th>126</th>\n      <td>2017.0</td>\n      <td>242.839</td>\n      <td>243.603</td>\n      <td>243.801</td>\n      <td>244.524</td>\n      <td>244.733</td>\n      <td>244.955</td>\n      <td>244.786</td>\n      <td>245.519</td>\n      <td>246.819</td>\n      <td>246.663</td>\n      <td>246.669</td>\n      <td>246.524</td>\n      <td>245.120</td>\n      <td>2.1</td>\n      <td>2.1</td>\n    </tr>\n    <tr>\n      <th>127</th>\n      <td>2018.0</td>\n      <td>247.867</td>\n      <td>248.991</td>\n      <td>249.554</td>\n      <td>250.546</td>\n      <td>251.588</td>\n      <td>251.989</td>\n      <td>252.006</td>\n      <td>252.146</td>\n      <td>252.439</td>\n      <td>252.885</td>\n      <td>252.038</td>\n      <td>251.233</td>\n      <td>251.107</td>\n      <td>1.9</td>\n      <td>2.4</td>\n    </tr>\n    <tr>\n      <th>128</th>\n      <td>2019.0</td>\n      <td>251.712</td>\n      <td>252.776</td>\n      <td>254.202</td>\n      <td>255.548</td>\n      <td>256.092</td>\n      <td>256.143</td>\n      <td>256.571</td>\n      <td>256.558</td>\n      <td>256.759</td>\n      <td>257.346</td>\n      <td>257.208</td>\n      <td>256.974</td>\n      <td>255.657</td>\n      <td>2.3</td>\n      <td>1.8</td>\n    </tr>\n    <tr>\n      <th>129</th>\n      <td>2020.0</td>\n      <td>257.971</td>\n      <td>258.678</td>\n      <td>258.115</td>\n      <td>256.389</td>\n      <td>256.394</td>\n      <td>257.797</td>\n      <td>259.101</td>\n      <td>259.918</td>\n      <td>260.280</td>\n      <td>260.388</td>\n      <td>260.229</td>\n      <td>260.474</td>\n      <td>258.811</td>\n      <td>1.4</td>\n      <td>1.2</td>\n    </tr>\n  </tbody>\n</table>\n<p>108 rows × 16 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Retail Diesel Prices\n\nRetail Prices for Diesel (On-Highway) - All Types \\[Source: [Energy Information Administration](http://www.eia.gov/dnav/pet/pet_pri_gnd_a_epd2d_pte_dpgal_w.htm)]\n\nFile URL: https://www.eia.gov/dnav/pet/xls/PET_PRI_GND_A_EPD2D_PTE_DPGAL_W.xls\n\n::: {#68bc573b .cell execution_count=11}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_RetailDieselPrices = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"Retail Diesel Prices\",\n  header=22,\n  usecols=\"A:J\", # TODO: update cols later for new data\n  nrows=1451\n)\n\n# display the data\ndf_RetailDieselPrices\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Weekly East Coast No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly New England (PADD 1A) No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly Central Atlantic (PADD 1B) No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly Lower Atlantic (PADD 1C) No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly Midwest No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly Gulf Coast No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly Rocky Mountain No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly West Coast No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n      <th>Weekly West Coast (PADD 5) Except California No 2 Diesel Retail Prices  (Dollars per Gallon)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1994-03-21</td>\n      <td>1.119</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.087</td>\n      <td>1.065</td>\n      <td>1.105</td>\n      <td>1.209</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1994-03-28</td>\n      <td>1.115</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.089</td>\n      <td>1.064</td>\n      <td>1.100</td>\n      <td>1.220</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1994-04-04</td>\n      <td>1.122</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.087</td>\n      <td>1.069</td>\n      <td>1.103</td>\n      <td>1.219</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1994-04-11</td>\n      <td>1.119</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.090</td>\n      <td>1.066</td>\n      <td>1.111</td>\n      <td>1.209</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994-04-18</td>\n      <td>1.115</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.086</td>\n      <td>1.058</td>\n      <td>1.118</td>\n      <td>1.213</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1446</th>\n      <td>2021-12-06</td>\n      <td>3.658</td>\n      <td>3.654</td>\n      <td>3.824</td>\n      <td>3.556</td>\n      <td>3.536</td>\n      <td>3.402</td>\n      <td>3.780</td>\n      <td>4.416</td>\n      <td>3.992</td>\n    </tr>\n    <tr>\n      <th>1447</th>\n      <td>2021-12-13</td>\n      <td>3.633</td>\n      <td>3.643</td>\n      <td>3.811</td>\n      <td>3.521</td>\n      <td>3.512</td>\n      <td>3.372</td>\n      <td>3.758</td>\n      <td>4.398</td>\n      <td>3.970</td>\n    </tr>\n    <tr>\n      <th>1448</th>\n      <td>2021-12-20</td>\n      <td>3.611</td>\n      <td>3.633</td>\n      <td>3.792</td>\n      <td>3.496</td>\n      <td>3.492</td>\n      <td>3.339</td>\n      <td>3.731</td>\n      <td>4.381</td>\n      <td>3.941</td>\n    </tr>\n    <tr>\n      <th>1449</th>\n      <td>2021-12-27</td>\n      <td>3.602</td>\n      <td>3.623</td>\n      <td>3.779</td>\n      <td>3.488</td>\n      <td>3.479</td>\n      <td>3.330</td>\n      <td>3.704</td>\n      <td>4.371</td>\n      <td>3.917</td>\n    </tr>\n    <tr>\n      <th>1450</th>\n      <td>2022-01-03</td>\n      <td>3.604</td>\n      <td>3.622</td>\n      <td>3.781</td>\n      <td>3.490</td>\n      <td>3.477</td>\n      <td>3.328</td>\n      <td>3.687</td>\n      <td>4.369</td>\n      <td>3.927</td>\n    </tr>\n  </tbody>\n</table>\n<p>1451 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Retail Gas Prices\n\nRetail Prices for Gasoline, All Grades \\[Source: [Energy Information Administration](https://www.eia.gov/dnav/pet/pet_pri_gnd_a_epm0_pte_dpgal_w.htm)]\n\nFile URL: https://www.eia.gov/dnav/pet/xls/PET_PRI_GND_A_EPM0_PTE_DPGAL_W.xls\n\n::: {#15880891 .cell execution_count=12}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_RetailGasPrices = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"Retail Gas Prices\",\n  header=22,\n  usecols=\"A:J\", # TODO: update cols later for new data\n  nrows=1501\n)\n\n# display the data\ndf_RetailGasPrices\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Weekly East Coast All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly New England (PADD 1A) All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly Central Atlantic (PADD 1B) All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly Lower Atlantic (PADD 1C) All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly Midwest All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly Gulf Coast All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly Rocky Mountain All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly West Coast All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n      <th>Weekly West Coast (PADD 5) Except California All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1993-04-05</td>\n      <td>1.040</td>\n      <td>1.068</td>\n      <td>1.068</td>\n      <td>1.023</td>\n      <td>1.061</td>\n      <td>1.064</td>\n      <td>1.093</td>\n      <td>1.152</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1993-04-12</td>\n      <td>1.047</td>\n      <td>1.073</td>\n      <td>1.072</td>\n      <td>1.032</td>\n      <td>1.077</td>\n      <td>1.071</td>\n      <td>1.118</td>\n      <td>1.154</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1993-04-19</td>\n      <td>1.054</td>\n      <td>1.074</td>\n      <td>1.077</td>\n      <td>1.040</td>\n      <td>1.067</td>\n      <td>1.081</td>\n      <td>1.120</td>\n      <td>1.155</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993-04-26</td>\n      <td>1.059</td>\n      <td>1.076</td>\n      <td>1.080</td>\n      <td>1.046</td>\n      <td>1.078</td>\n      <td>1.081</td>\n      <td>1.169</td>\n      <td>1.157</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1993-05-03</td>\n      <td>1.062</td>\n      <td>1.080</td>\n      <td>1.084</td>\n      <td>1.050</td>\n      <td>1.073</td>\n      <td>1.084</td>\n      <td>1.161</td>\n      <td>1.161</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1496</th>\n      <td>2021-12-06</td>\n      <td>3.380</td>\n      <td>3.484</td>\n      <td>3.531</td>\n      <td>3.258</td>\n      <td>3.167</td>\n      <td>3.061</td>\n      <td>3.579</td>\n      <td>4.285</td>\n      <td>3.853</td>\n    </tr>\n    <tr>\n      <th>1497</th>\n      <td>2021-12-13</td>\n      <td>3.359</td>\n      <td>3.467</td>\n      <td>3.526</td>\n      <td>3.226</td>\n      <td>3.144</td>\n      <td>3.012</td>\n      <td>3.543</td>\n      <td>4.265</td>\n      <td>3.826</td>\n    </tr>\n    <tr>\n      <th>1498</th>\n      <td>2021-12-20</td>\n      <td>3.340</td>\n      <td>3.458</td>\n      <td>3.519</td>\n      <td>3.198</td>\n      <td>3.111</td>\n      <td>3.011</td>\n      <td>3.520</td>\n      <td>4.251</td>\n      <td>3.808</td>\n    </tr>\n    <tr>\n      <th>1499</th>\n      <td>2021-12-27</td>\n      <td>3.328</td>\n      <td>3.448</td>\n      <td>3.507</td>\n      <td>3.183</td>\n      <td>3.092</td>\n      <td>2.978</td>\n      <td>3.499</td>\n      <td>4.235</td>\n      <td>3.795</td>\n    </tr>\n    <tr>\n      <th>1500</th>\n      <td>2022-01-03</td>\n      <td>3.321</td>\n      <td>3.444</td>\n      <td>3.496</td>\n      <td>3.177</td>\n      <td>3.093</td>\n      <td>3.015</td>\n      <td>3.476</td>\n      <td>4.249</td>\n      <td>3.806</td>\n    </tr>\n  </tbody>\n</table>\n<p>1501 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Average Cost\n\nTable 3-17:  Average Cost of Owning and Operating an Automobilea (Assuming 15,000 Vehicle-Miles per Year) \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#7a74f690 .cell execution_count=13}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_AverageCost = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Auto Cost & Gas Price.xlsx\",\n  sheet_name=\"3-17\",\n  header=1,\n  usecols=\"A:AI\", # TODO: update cols later for new data\n  nrows=8\n)\n\n# display the data\ndf_AverageCost\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>1995</th>\n      <th>...</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n      <th>2020</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Average total cost per mile (current cents)</td>\n      <td>14.360000</td>\n      <td>21.173333</td>\n      <td>23.226667</td>\n      <td>33.026667</td>\n      <td>37.340000</td>\n      <td>38.826667</td>\n      <td>38.693333</td>\n      <td>39.440000</td>\n      <td>41.233333</td>\n      <td>...</td>\n      <td>58.506667</td>\n      <td>59.640000</td>\n      <td>60.813333</td>\n      <td>59.173333</td>\n      <td>57.986667</td>\n      <td>57.053333</td>\n      <td>56.453333</td>\n      <td>58.993333</td>\n      <td>61.88</td>\n      <td>63.74</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Gasb</td>\n      <td>4.800000</td>\n      <td>5.900000</td>\n      <td>5.570000</td>\n      <td>5.400000</td>\n      <td>6.600000</td>\n      <td>5.900000</td>\n      <td>5.900000</td>\n      <td>5.600000</td>\n      <td>5.800000</td>\n      <td>...</td>\n      <td>12.340000</td>\n      <td>14.170000</td>\n      <td>14.450000</td>\n      <td>13.000000</td>\n      <td>11.210000</td>\n      <td>8.450000</td>\n      <td>10.26</td>\n      <td>11.05</td>\n      <td>11.6</td>\n      <td>10.66</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Gas as a percent of total costb</td>\n      <td>33.426184</td>\n      <td>27.865239</td>\n      <td>23.981056</td>\n      <td>16.350424</td>\n      <td>17.675415</td>\n      <td>15.195742</td>\n      <td>15.248105</td>\n      <td>14.198783</td>\n      <td>14.066289</td>\n      <td>...</td>\n      <td>21.091613</td>\n      <td>23.759222</td>\n      <td>23.761237</td>\n      <td>21.969356</td>\n      <td>19.332030</td>\n      <td>14.810703</td>\n      <td>18.174303</td>\n      <td>18.73093</td>\n      <td>18.74596</td>\n      <td>16.724192</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Maintenancec</td>\n      <td>0.970000</td>\n      <td>1.120000</td>\n      <td>1.200000</td>\n      <td>2.100000</td>\n      <td>2.200000</td>\n      <td>2.200000</td>\n      <td>2.400000</td>\n      <td>2.500000</td>\n      <td>2.600000</td>\n      <td>...</td>\n      <td>4.440000</td>\n      <td>4.470000</td>\n      <td>4.970000</td>\n      <td>5.060000</td>\n      <td>5.110000</td>\n      <td>5.280000</td>\n      <td>7.91</td>\n      <td>8.21</td>\n      <td>8.94</td>\n      <td>9.12</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Tires</td>\n      <td>0.660000</td>\n      <td>0.640000</td>\n      <td>0.650000</td>\n      <td>0.900000</td>\n      <td>0.900000</td>\n      <td>0.900000</td>\n      <td>0.900000</td>\n      <td>1.000000</td>\n      <td>1.200000</td>\n      <td>...</td>\n      <td>0.960000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>0.970000</td>\n      <td>0.980000</td>\n      <td>1.000000</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Average total cost per 15,000 miles (current d...</td>\n      <td>2154.000000</td>\n      <td>3176.000000</td>\n      <td>3484.000000</td>\n      <td>4954.000000</td>\n      <td>5601.000000</td>\n      <td>5824.000000</td>\n      <td>5804.000000</td>\n      <td>5916.000000</td>\n      <td>6185.000000</td>\n      <td>...</td>\n      <td>8776.000000</td>\n      <td>8946.000000</td>\n      <td>9122.000000</td>\n      <td>8876.000000</td>\n      <td>8698.000000</td>\n      <td>8558.000000</td>\n      <td>8468</td>\n      <td>8849</td>\n      <td>9282</td>\n      <td>9561</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Variable cost</td>\n      <td>968.000000</td>\n      <td>1143.000000</td>\n      <td>1113.000000</td>\n      <td>1260.000000</td>\n      <td>1455.000000</td>\n      <td>1350.000000</td>\n      <td>1380.000000</td>\n      <td>1365.000000</td>\n      <td>1440.000000</td>\n      <td>...</td>\n      <td>2662.000000</td>\n      <td>2946.000000</td>\n      <td>3064.000000</td>\n      <td>2855.000000</td>\n      <td>2596.000000</td>\n      <td>2208.000000</td>\n      <td>2726</td>\n      <td>2889</td>\n      <td>3081</td>\n      <td>2968</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Fixed costd</td>\n      <td>1186.000000</td>\n      <td>2033.000000</td>\n      <td>2371.000000</td>\n      <td>3694.000000</td>\n      <td>4146.000000</td>\n      <td>4474.000000</td>\n      <td>4424.000000</td>\n      <td>4551.000000</td>\n      <td>4745.000000</td>\n      <td>...</td>\n      <td>6114.000000</td>\n      <td>6000.000000</td>\n      <td>6058.000000</td>\n      <td>6021.000000</td>\n      <td>6102.000000</td>\n      <td>6350.000000</td>\n      <td>5742</td>\n      <td>5960</td>\n      <td>6201</td>\n      <td>6593</td>\n    </tr>\n  </tbody>\n</table>\n<p>8 rows × 35 columns</p>\n</div>\n```\n:::\n:::\n\n\n### 4-11\n\nTable 4-11: Light Duty Vehicle, Short Wheel Base and Motorcycle Fuel Consumption and Travel \\[Source: [Bureau of Transportation Statistics](https://www.bts.gov/content/light-duty-vehicle-short-wheel-base-and-motorcycle-fuel-consumption-and-travel)]\n\nFile URL: https://www.bts.gov/sites/bts.dot.gov/files/2025-03/table_04_11_032825.xlsx\n\n::: {#43007fdd .cell execution_count=14}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_4_11 = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"4-11\",\n  header=1,\n  usecols=\"A:AK\", # TODO: update cols later for new data\n  nrows=18\n)\n\n# display the data\ndf_4_11\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1960</th>\n      <th>1965</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Vehicles registered (thousands)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>61671.39</td>\n      <td>75257.588</td>\n      <td>89243.557</td>\n      <td>106705.934</td>\n      <td>121600.843</td>\n      <td>127885.193</td>\n      <td>133700.496</td>\n      <td>128299.601</td>\n      <td>126581.148</td>\n      <td>...</td>\n      <td>1.902028e+05</td>\n      <td>1.835226e+05</td>\n      <td>1.831719e+05</td>\n      <td>1.844975e+05</td>\n      <td>1.875549e+05</td>\n      <td>1.896183e+05</td>\n      <td>1.927745e+05</td>\n      <td>1.936724e+05</td>\n      <td>1.928562e+05</td>\n      <td>1.943488e+05</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Motorcycles</td>\n      <td>574.032</td>\n      <td>1381.956</td>\n      <td>2824.098</td>\n      <td>4964.07</td>\n      <td>5693.94</td>\n      <td>5444.404</td>\n      <td>4259.462</td>\n      <td>4177.365</td>\n      <td>4065.118</td>\n      <td>...</td>\n      <td>8.009503e+03</td>\n      <td>8.437502e+03</td>\n      <td>8.454939e+03</td>\n      <td>8.404687e+03</td>\n      <td>8.417718e+03</td>\n      <td>8.600936e+03</td>\n      <td>8.679380e+03</td>\n      <td>8.715204e+03</td>\n      <td>8.666185e+03</td>\n      <td>8.596314e+03</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Vehicle-miles traveled (millions)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>587011.529483</td>\n      <td>722696.376126</td>\n      <td>919679</td>\n      <td>1039579</td>\n      <td>1121810</td>\n      <td>1255883.959441</td>\n      <td>1417822.868873</td>\n      <td>1367363.284333</td>\n      <td>1381126.078561</td>\n      <td>...</td>\n      <td>2.025745e+06</td>\n      <td>2.046282e+06</td>\n      <td>2.062828e+06</td>\n      <td>2.074423e+06</td>\n      <td>2.072071e+06</td>\n      <td>2.147840e+06</td>\n      <td>2.191764e+06</td>\n      <td>2.220801e+06</td>\n      <td>2.232588e+06</td>\n      <td>2.254309e+06</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Motorcycles</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>...</td>\n      <td>1.851290e+04</td>\n      <td>1.854223e+04</td>\n      <td>2.138531e+04</td>\n      <td>2.036618e+04</td>\n      <td>1.996967e+04</td>\n      <td>1.960631e+04</td>\n      <td>2.044530e+04</td>\n      <td>2.014930e+04</td>\n      <td>2.007618e+04</td>\n      <td>1.968805e+04</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Fuel consumed (million gallons)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>41170.908</td>\n      <td>49723</td>\n      <td>67879.088</td>\n      <td>74252.665012</td>\n      <td>70185.568749</td>\n      <td>71699.79422</td>\n      <td>69759.41511</td>\n      <td>64501.153523</td>\n      <td>65626.886464</td>\n      <td>...</td>\n      <td>8.678852e+04</td>\n      <td>8.835866e+04</td>\n      <td>8.860021e+04</td>\n      <td>8.861101e+04</td>\n      <td>8.930079e+04</td>\n      <td>9.003127e+04</td>\n      <td>9.148781e+04</td>\n      <td>9.171216e+04</td>\n      <td>9.158533e+04</td>\n      <td>9.342037e+04</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Motorcycles</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>...</td>\n      <td>4.267318e+02</td>\n      <td>4.263775e+02</td>\n      <td>4.911303e+02</td>\n      <td>4.677127e+02</td>\n      <td>4.586283e+02</td>\n      <td>4.478787e+02</td>\n      <td>4.658022e+02</td>\n      <td>4.584286e+02</td>\n      <td>4.566574e+02</td>\n      <td>4.478637e+02</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Average miles traveled per vehicle (thousands)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>9.518377</td>\n      <td>9.60297</td>\n      <td>10.305271</td>\n      <td>9.742467</td>\n      <td>9.225347</td>\n      <td>9.820402</td>\n      <td>10.60447</td>\n      <td>10.65758</td>\n      <td>10.910993</td>\n      <td>...</td>\n      <td>1.065045e+01</td>\n      <td>1.115003e+01</td>\n      <td>1.126171e+01</td>\n      <td>1.124364e+01</td>\n      <td>1.104781e+01</td>\n      <td>1.132718e+01</td>\n      <td>1.136957e+01</td>\n      <td>1.146679e+01</td>\n      <td>1.157644e+01</td>\n      <td>1.159929e+01</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Motorcycles</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>...</td>\n      <td>2.311367e+00</td>\n      <td>2.197598e+00</td>\n      <td>2.529328e+00</td>\n      <td>2.423193e+00</td>\n      <td>2.372338e+00</td>\n      <td>2.279556e+00</td>\n      <td>2.355618e+00</td>\n      <td>2.311971e+00</td>\n      <td>2.316611e+00</td>\n      <td>2.290289e+00</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Average miles traveled per gallon</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>14.25792</td>\n      <td>14.534448</td>\n      <td>13.548783</td>\n      <td>14.000561</td>\n      <td>15.983485</td>\n      <td>17.515866</td>\n      <td>20.324466</td>\n      <td>21.199052</td>\n      <td>21.045126</td>\n      <td>...</td>\n      <td>2.334116e+01</td>\n      <td>2.315882e+01</td>\n      <td>2.328242e+01</td>\n      <td>2.341044e+01</td>\n      <td>2.320328e+01</td>\n      <td>2.385661e+01</td>\n      <td>2.395690e+01</td>\n      <td>2.421490e+01</td>\n      <td>2.437713e+01</td>\n      <td>2.413081e+01</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Motorcycles</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>...</td>\n      <td>4.338299e+01</td>\n      <td>4.348783e+01</td>\n      <td>4.354306e+01</td>\n      <td>4.354421e+01</td>\n      <td>4.354216e+01</td>\n      <td>4.377595e+01</td>\n      <td>4.389267e+01</td>\n      <td>4.395297e+01</td>\n      <td>4.396332e+01</td>\n      <td>4.395991e+01</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Average fuel consumed per vehicle (gallons)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Light duty vehicles, short wheel basea</td>\n      <td>667.585213</td>\n      <td>660.704141</td>\n      <td>760.604914</td>\n      <td>695.862566</td>\n      <td>577.179952</td>\n      <td>560.657513</td>\n      <td>521.758836</td>\n      <td>502.738536</td>\n      <td>518.457033</td>\n      <td>...</td>\n      <td>4.562947e+02</td>\n      <td>4.814592e+02</td>\n      <td>4.836999e+02</td>\n      <td>4.802830e+02</td>\n      <td>4.761314e+02</td>\n      <td>4.748026e+02</td>\n      <td>4.745846e+02</td>\n      <td>4.735428e+02</td>\n      <td>4.748892e+02</td>\n      <td>4.806840e+02</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Motorcycles</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>U</td>\n      <td>...</td>\n      <td>5.327819e+01</td>\n      <td>5.053362e+01</td>\n      <td>5.808798e+01</td>\n      <td>5.564904e+01</td>\n      <td>5.448369e+01</td>\n      <td>5.207325e+01</td>\n      <td>5.366769e+01</td>\n      <td>5.260102e+01</td>\n      <td>5.269416e+01</td>\n      <td>5.209950e+01</td>\n    </tr>\n  </tbody>\n</table>\n<p>18 rows × 37 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy - Medium\n\nTable 4-13:  Single-Unit 2-Axle 6-Tire or More Truck Fuel Consumption and Travel \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#4df7245d .cell execution_count=15}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_FE_Medium = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"Medium\",\n  header=1,\n  usecols=\"A:AI\", # TODO: update cols later for new data\n  nrows=6\n)\n\n# display the data\ndf_FE_Medium\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>1994</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Number registered (thousands)</td>\n      <td>3681.405000</td>\n      <td>4231.622000</td>\n      <td>4373.784000</td>\n      <td>4593.071446</td>\n      <td>4486.981096</td>\n      <td>4480.815015</td>\n      <td>4369.842228</td>\n      <td>4407.850444</td>\n      <td>4724.608000</td>\n      <td>...</td>\n      <td>8217.189071</td>\n      <td>7819.054746</td>\n      <td>8190.286364</td>\n      <td>8126.007221</td>\n      <td>8328.758599</td>\n      <td>8456.302000</td>\n      <td>8746.518000</td>\n      <td>9336.998000</td>\n      <td>10327.899000</td>\n      <td>10160.433000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Vehicle-miles (millions)</td>\n      <td>27081.000000</td>\n      <td>34606.000000</td>\n      <td>39813.000000</td>\n      <td>45441.010136</td>\n      <td>51901.084690</td>\n      <td>52897.923062</td>\n      <td>53874.244546</td>\n      <td>56772.473176</td>\n      <td>61284.000000</td>\n      <td>...</td>\n      <td>110738.245206</td>\n      <td>103803.030273</td>\n      <td>105605.222597</td>\n      <td>106581.578905</td>\n      <td>109301.406197</td>\n      <td>109597.318450</td>\n      <td>113337.941633</td>\n      <td>116102.399109</td>\n      <td>120698.994215</td>\n      <td>124745.707181</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Fuel consumed (million gallons)</td>\n      <td>3968.375000</td>\n      <td>5420.485711</td>\n      <td>6922.767279</td>\n      <td>7399.378701</td>\n      <td>8356.675584</td>\n      <td>8172.381947</td>\n      <td>8236.926852</td>\n      <td>8488.204295</td>\n      <td>9031.771537</td>\n      <td>...</td>\n      <td>15096.529868</td>\n      <td>14215.430675</td>\n      <td>14376.472744</td>\n      <td>14501.925786</td>\n      <td>14893.865294</td>\n      <td>14850.509537</td>\n      <td>15338.478728</td>\n      <td>15599.855130</td>\n      <td>16080.121829</td>\n      <td>16656.735671</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Average miles traveled per vehicle (thousands)</td>\n      <td>7.356159</td>\n      <td>8.177952</td>\n      <td>9.102644</td>\n      <td>9.893382</td>\n      <td>11.567039</td>\n      <td>11.805424</td>\n      <td>12.328648</td>\n      <td>12.879855</td>\n      <td>12.971235</td>\n      <td>...</td>\n      <td>13.476414</td>\n      <td>13.275650</td>\n      <td>12.893960</td>\n      <td>13.116107</td>\n      <td>13.123373</td>\n      <td>12.960431</td>\n      <td>12.958064</td>\n      <td>12.434660</td>\n      <td>11.686694</td>\n      <td>12.277598</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Average miles traveled per gallon</td>\n      <td>6.824204</td>\n      <td>6.384299</td>\n      <td>5.751024</td>\n      <td>6.141193</td>\n      <td>6.210733</td>\n      <td>6.472767</td>\n      <td>6.540576</td>\n      <td>6.688396</td>\n      <td>6.785380</td>\n      <td>...</td>\n      <td>7.335344</td>\n      <td>7.302138</td>\n      <td>7.345698</td>\n      <td>7.349478</td>\n      <td>7.338686</td>\n      <td>7.380038</td>\n      <td>7.389125</td>\n      <td>7.442531</td>\n      <td>7.506099</td>\n      <td>7.489205</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Average fuel consumed per vehicle (gallons)</td>\n      <td>1077.951217</td>\n      <td>1280.947521</td>\n      <td>1582.786731</td>\n      <td>1610.987068</td>\n      <td>1862.427187</td>\n      <td>1823.860597</td>\n      <td>1884.948340</td>\n      <td>1925.701519</td>\n      <td>1911.644635</td>\n      <td>...</td>\n      <td>1837.189060</td>\n      <td>1818.049769</td>\n      <td>1755.307703</td>\n      <td>1784.631171</td>\n      <td>1788.245525</td>\n      <td>1756.147018</td>\n      <td>1753.666857</td>\n      <td>1670.757039</td>\n      <td>1556.959632</td>\n      <td>1639.372620</td>\n    </tr>\n  </tbody>\n</table>\n<p>6 rows × 35 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy - Heavy\n\nTable 4-14:  Combination Truck Fuel Consumption and Travel \\[Source: Bureau of Transportation Statistics\\]\n\n::: {#8f120482 .cell execution_count=16}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_FE_Heavy = pd.read_excel(\n  \"archive-v9.0\\\\Support Data\\\\BTS - National - Fuel Efficiency.xlsx\",\n  sheet_name=\"Heavy\",\n  header=1,\n  usecols=\"A:AJ\", # TODO: update cols later for new data\n  nrows=6\n)\n\n# display the data\ndf_FE_Heavy\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>1965</th>\n      <th>1970</th>\n      <th>1975</th>\n      <th>1980</th>\n      <th>1985</th>\n      <th>1990</th>\n      <th>1991</th>\n      <th>1992</th>\n      <th>1993</th>\n      <th>...</th>\n      <th>2010</th>\n      <th>2011</th>\n      <th>2012</th>\n      <th>2013</th>\n      <th>2014</th>\n      <th>2015</th>\n      <th>2016</th>\n      <th>2017</th>\n      <th>2018</th>\n      <th>2019</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Number registered (thousands)</td>\n      <td>786.510352</td>\n      <td>905.082000</td>\n      <td>1130.747000</td>\n      <td>1416.869000</td>\n      <td>1403.266000</td>\n      <td>1708.894894</td>\n      <td>1691.330985</td>\n      <td>1675.362942</td>\n      <td>1680.305013</td>\n      <td>...</td>\n      <td>2552.865009</td>\n      <td>2451.638193</td>\n      <td>2469.093851</td>\n      <td>2471.348703</td>\n      <td>2577.197369</td>\n      <td>2746.882000</td>\n      <td>2752.043000</td>\n      <td>2892.218000</td>\n      <td>2906.011000</td>\n      <td>2925.210000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Vehicle-miles traveled (millions)</td>\n      <td>31665.008552</td>\n      <td>35134.000000</td>\n      <td>46724.000000</td>\n      <td>68678.000000</td>\n      <td>78062.829300</td>\n      <td>94341.074342</td>\n      <td>96644.537280</td>\n      <td>99509.826717</td>\n      <td>103115.689682</td>\n      <td>...</td>\n      <td>175788.971737</td>\n      <td>163791.293119</td>\n      <td>163601.731106</td>\n      <td>168435.634141</td>\n      <td>169830.178385</td>\n      <td>170246.278000</td>\n      <td>174556.978274</td>\n      <td>181490.181698</td>\n      <td>184165.121151</td>\n      <td>175304.701353</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Fuel consumed (million gallons)</td>\n      <td>6658.000000</td>\n      <td>7347.937000</td>\n      <td>9177.475579</td>\n      <td>13037.002826</td>\n      <td>14005.271116</td>\n      <td>16132.920179</td>\n      <td>16808.623869</td>\n      <td>17216.232996</td>\n      <td>17747.967243</td>\n      <td>...</td>\n      <td>29926.663579</td>\n      <td>28181.038987</td>\n      <td>27975.331348</td>\n      <td>28794.994112</td>\n      <td>29117.656112</td>\n      <td>28885.913526</td>\n      <td>29554.641135</td>\n      <td>30363.560805</td>\n      <td>30325.060257</td>\n      <td>28986.514576</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Average miles traveled per vehicle (thousands)</td>\n      <td>40.260129</td>\n      <td>38.818582</td>\n      <td>41.321357</td>\n      <td>48.471665</td>\n      <td>55.629388</td>\n      <td>55.205896</td>\n      <td>57.141114</td>\n      <td>59.395982</td>\n      <td>61.367245</td>\n      <td>...</td>\n      <td>68.859486</td>\n      <td>66.808917</td>\n      <td>66.259827</td>\n      <td>68.155349</td>\n      <td>65.897234</td>\n      <td>61.978009</td>\n      <td>63.428143</td>\n      <td>62.751211</td>\n      <td>63.373855</td>\n      <td>59.928929</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Average miles traveled per gallon</td>\n      <td>4.755934</td>\n      <td>4.781478</td>\n      <td>5.091160</td>\n      <td>5.267929</td>\n      <td>5.573818</td>\n      <td>5.847737</td>\n      <td>5.749700</td>\n      <td>5.780000</td>\n      <td>5.810000</td>\n      <td>...</td>\n      <td>5.873992</td>\n      <td>5.812110</td>\n      <td>5.848071</td>\n      <td>5.849476</td>\n      <td>5.832550</td>\n      <td>5.893747</td>\n      <td>5.906246</td>\n      <td>5.977236</td>\n      <td>6.073034</td>\n      <td>6.047802</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Average fuel consumed per vehicle (gallons)</td>\n      <td>8465.241403</td>\n      <td>8118.531802</td>\n      <td>8116.294431</td>\n      <td>9201.276071</td>\n      <td>9980.482044</td>\n      <td>9440.557310</td>\n      <td>9938.104379</td>\n      <td>10276.121406</td>\n      <td>10562.348563</td>\n      <td>...</td>\n      <td>11722.775576</td>\n      <td>11494.778906</td>\n      <td>11330.201701</td>\n      <td>11651.530224</td>\n      <td>11298.186339</td>\n      <td>10515.891664</td>\n      <td>10739.164008</td>\n      <td>10498.365201</td>\n      <td>10435.287498</td>\n      <td>9909.208083</td>\n    </tr>\n  </tbody>\n</table>\n<p>6 rows × 36 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy by Size Class\n\nTable 5.5 Truck Harmonic Mean Fuel Economy by Size Class, 1992, 1997, and 2002 (miles per gallon)\n\n::: {#2deb1a13 .cell execution_count=17}\n``` {.python .cell-code}\n# FIXME: Need to verify the source of this.\n\n# Read Excel file directly from URL\ndf_FE_SizeClass_1 = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"Fuel Economy by Size Class\",\n  usecols=\"A:G\", # TODO: update cols later for new data\n  skiprows=11,   # Skip the first 11 rows\n  nrows=11\n)\n\n# Drop columns that are entirely empty (NaN)\ndf_FE_SizeClass_1 = df_FE_SizeClass_1.dropna(axis=1, how='all')\n\n# Manually set column names\ndf_FE_SizeClass_1.columns = [\n    \"Manufacturer's gross vehicle weight class\",\n    \"1992 TIUS\",\n    \"1997 VIUS\",\n    \"2002 VIUS\"\n]\n\n# display the data\ndf_FE_SizeClass_1\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Manufacturer's gross vehicle weight class</th>\n      <th>1992 TIUS</th>\n      <th>1997 VIUS</th>\n      <th>2002 VIUS</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1) 6,000 lbs and less</td>\n      <td>17.2</td>\n      <td>17.1</td>\n      <td>17.6</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2)  6,001–10,000 lbs</td>\n      <td>13.0</td>\n      <td>13.6</td>\n      <td>14.3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Light truck subtotal</td>\n      <td>15.7</td>\n      <td>15.8</td>\n      <td>16.2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3) 10,000–14,000 lbs</td>\n      <td>8.8</td>\n      <td>9.4</td>\n      <td>10.5</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4)  14,001–16,000 lbs</td>\n      <td>8.8</td>\n      <td>9.3</td>\n      <td>8.5</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5)  16,001–19,500 lbs</td>\n      <td>7.4</td>\n      <td>8.7</td>\n      <td>7.9</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>6)  19,501–26,000 lbs</td>\n      <td>6.9</td>\n      <td>7.3</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Medium truck subtotal</td>\n      <td>7.3</td>\n      <td>8.6</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>7)  26,001–33,000 lbs</td>\n      <td>6.5</td>\n      <td>6.4</td>\n      <td>6.4</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>8)  33,001 lbs  and over</td>\n      <td>5.5</td>\n      <td>5.7</td>\n      <td>5.7</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Large truck subtotal</td>\n      <td>5.6</td>\n      <td>6.1</td>\n      <td>5.8</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nTable 10.4:  Retail Prices for Motor Fuel, 1978–2012 (cents per gallon, including tax)\n\n::: {#3dab9537 .cell execution_count=18}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_FE_SizeClass_2 = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"Fuel Economy by Size Class\",\n  usecols=\"A:C\", # TODO: update cols later for new data\n  header=35,\n  nrows=1\n)\n\n# display the data\ndf_FE_SizeClass_2\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Diesel fuel</th>\n      <th>Average for all gasoline types</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2012</td>\n      <td>397</td>\n      <td>370</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#446b716c .cell execution_count=19}\n``` {.python .cell-code}\n# FIXME: Unsure the logic behind this calculation.\ndf_FE_SizeClass_2[\"Something\"] = df_FE_SizeClass_2[\"Diesel fuel\"]/df_FE_SizeClass_2[\"Average for all gasoline types\"]\n\ndf_FE_SizeClass_2[\"Something\"]\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```\n0    1.072973\nName: Something, dtype: float64\n```\n:::\n:::\n\n\n### Repair and Maintenance Cost - Heavy\n\n![Repair and Maintenance Cost per Mile](https://fleetimages.bobitstudios.com/upload/trucking-info/content/article/2021-08/maintenance_chart4-__-720x516-s.jpg)\n\nSource: https://www.truckinginfo.com/10150350/2021-hdt-fact-book-maintenance-costs-expected-to-rise\n\nFurther Research: American Transportation Research Institute\n\n::: {#2994a4ee .cell execution_count=20}\n``` {.python .cell-code}\n# Manually Entering the data from above image\ndf_RepairMaintenanceCost_Heavy = pd.DataFrame({\n    \"Year\": [\"2010\", \"2011\", \"2012\", \"2013\", \"2014\", \"2015\", \"2016\", \"2017\", \"2018\", \"2019\"],\n    \"CostMile\": [0.124, 0.152, 0.138, 0.148, 0.158, 0.156, 0.166, 0.167, 0.171, 0.14]\n})\n\n# display the data\ndf_RepairMaintenanceCost_Heavy\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>CostMile</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2010</td>\n      <td>0.124</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2011</td>\n      <td>0.152</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2012</td>\n      <td>0.138</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2013</td>\n      <td>0.148</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014</td>\n      <td>0.158</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2015</td>\n      <td>0.156</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2016</td>\n      <td>0.166</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2017</td>\n      <td>0.167</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2018</td>\n      <td>0.171</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2019</td>\n      <td>0.140</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Driving Costs\n\nData Source: https://exchange.aaa.com/wp-content/uploads/2019/09/AAA-Your-Driving-Costs-2019.pdf\n\n::: {#e671d7df .cell execution_count=21}\n``` {.python .cell-code}\n# Read Excel file directly from URL\ndf_DrivingCosts = pd.read_excel(\n  \"archive-v9.0\\\\1 - Auto Operating Cost - 2022-01-11.xlsx\", # File path\n  sheet_name=\"Driving Costs\",\n  usecols=\"A:K\", # TODO: update cols later for new data\n  skiprows=3,     # Skip the first 3 rows\n  nrows=31\n)\n\n# Manually set column names\ndf_DrivingCosts.columns = [\n    \"Cost Categories\",\n    \"Small Sedan\",\n    \"Medium Sedan\",\n    \"Large Sedan\",\n    \"Small SUV (FWD)\",\n    \"Medium SUV (FWD)\",\n    \"Minivan\",\n    \"1/2 Ton/Crew Pickup (4WD)\",\n    \"Hybrid Vehicle\",\n    \"Electric Vehicle\",\n    \"2020 Weighted Average\"\n]\n\n# display the data\ndf_DrivingCosts\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Cost Categories</th>\n      <th>Small Sedan</th>\n      <th>Medium Sedan</th>\n      <th>Large Sedan</th>\n      <th>Small SUV (FWD)</th>\n      <th>Medium SUV (FWD)</th>\n      <th>Minivan</th>\n      <th>1/2 Ton/Crew Pickup (4WD)</th>\n      <th>Hybrid Vehicle</th>\n      <th>Electric Vehicle</th>\n      <th>2020 Weighted Average</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>fuel</td>\n      <td>8.3600</td>\n      <td>9.2700</td>\n      <td>12.7700</td>\n      <td>9.4200</td>\n      <td>13.2000</td>\n      <td>12.6100</td>\n      <td>15.6700</td>\n      <td>5.7600</td>\n      <td>3.6500</td>\n      <td>11.6000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>maintenance</td>\n      <td>8.5300</td>\n      <td>9.1800</td>\n      <td>9.4900</td>\n      <td>9.0900</td>\n      <td>9.6000</td>\n      <td>8.7300</td>\n      <td>8.7700</td>\n      <td>7.7000</td>\n      <td>6.6000</td>\n      <td>8.9400</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>cost per mile</td>\n      <td>16.8900</td>\n      <td>18.4500</td>\n      <td>22.2600</td>\n      <td>18.5100</td>\n      <td>22.8000</td>\n      <td>21.3400</td>\n      <td>24.4400</td>\n      <td>13.4600</td>\n      <td>10.2500</td>\n      <td>20.5400</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Ownership Costs</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>full-coverage insurance</td>\n      <td>1328.0000</td>\n      <td>1251.0000</td>\n      <td>1221.0000</td>\n      <td>1089.0000</td>\n      <td>1114.0000</td>\n      <td>1103.0000</td>\n      <td>1236.0000</td>\n      <td>1202.0000</td>\n      <td>1203.0000</td>\n      <td>1194.0000</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>license, registration, taxes</td>\n      <td>466.0000</td>\n      <td>661.0000</td>\n      <td>807.0000</td>\n      <td>630.0000</td>\n      <td>862.0000</td>\n      <td>769.0000</td>\n      <td>1013.0000</td>\n      <td>639.0000</td>\n      <td>-519.0000</td>\n      <td>753.0000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>depreciation (15k mi/yr)</td>\n      <td>2240.0000</td>\n      <td>3169.0000</td>\n      <td>4061.0000</td>\n      <td>3132.0000</td>\n      <td>3794.0000</td>\n      <td>4036.0000</td>\n      <td>3696.0000</td>\n      <td>3087.0000</td>\n      <td>5250.0000</td>\n      <td>3334.0000</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>finance</td>\n      <td>546.0000</td>\n      <td>794.0000</td>\n      <td>975.0000</td>\n      <td>766.0000</td>\n      <td>1075.0000</td>\n      <td>927.0000</td>\n      <td>1228.0000</td>\n      <td>789.0000</td>\n      <td>848.0000</td>\n      <td>920.0000</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>cost per year</td>\n      <td>4580.0000</td>\n      <td>5875.0000</td>\n      <td>7064.0000</td>\n      <td>5617.0000</td>\n      <td>6845.0000</td>\n      <td>6835.0000</td>\n      <td>7173.0000</td>\n      <td>5717.0000</td>\n      <td>6782.0000</td>\n      <td>6201.0000</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>cost per day</td>\n      <td>12.5500</td>\n      <td>16.1000</td>\n      <td>19.3500</td>\n      <td>15.3900</td>\n      <td>18.7500</td>\n      <td>18.7300</td>\n      <td>19.6500</td>\n      <td>15.6600</td>\n      <td>18.5800</td>\n      <td>16.9900</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Total Cost per Mile - 10k mi/yr</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>cost per mile driven</td>\n      <td>1689.0000</td>\n      <td>1845.0000</td>\n      <td>2226.0000</td>\n      <td>1851.0000</td>\n      <td>2280.0000</td>\n      <td>2134.0000</td>\n      <td>2444.0000</td>\n      <td>1346.0000</td>\n      <td>1025.0000</td>\n      <td>2054.0000</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>cost per year</td>\n      <td>4580.0000</td>\n      <td>5875.0000</td>\n      <td>7064.0000</td>\n      <td>5617.0000</td>\n      <td>6845.0000</td>\n      <td>6835.0000</td>\n      <td>7173.0000</td>\n      <td>5717.0000</td>\n      <td>6782.0000</td>\n      <td>6201.0000</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>depreciation</td>\n      <td>-209.0000</td>\n      <td>-233.0000</td>\n      <td>-296.0000</td>\n      <td>-286.0000</td>\n      <td>-382.0000</td>\n      <td>-264.0000</td>\n      <td>-454.0000</td>\n      <td>-264.0000</td>\n      <td>-312.0000</td>\n      <td>-326.0000</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>total cost per year</td>\n      <td>6060.0000</td>\n      <td>7487.0000</td>\n      <td>8994.0000</td>\n      <td>7182.0000</td>\n      <td>8743.0000</td>\n      <td>8705.0000</td>\n      <td>9163.0000</td>\n      <td>6799.0000</td>\n      <td>7495.0000</td>\n      <td>7929.0000</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>cost per day</td>\n      <td>16.6000</td>\n      <td>20.5100</td>\n      <td>24.6400</td>\n      <td>19.6800</td>\n      <td>23.9500</td>\n      <td>23.8500</td>\n      <td>25.1000</td>\n      <td>18.6300</td>\n      <td>20.5300</td>\n      <td>21.7200</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>cost per mile</td>\n      <td>0.6060</td>\n      <td>0.7487</td>\n      <td>0.8994</td>\n      <td>0.7182</td>\n      <td>0.8743</td>\n      <td>0.8705</td>\n      <td>0.9163</td>\n      <td>0.6799</td>\n      <td>0.7495</td>\n      <td>0.7929</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Total Cost per Mile - 15k mi/yr</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>cost per mile driven</td>\n      <td>2534.0000</td>\n      <td>2768.0000</td>\n      <td>3339.0000</td>\n      <td>2777.0000</td>\n      <td>3420.0000</td>\n      <td>3201.0000</td>\n      <td>3666.0000</td>\n      <td>2019.0000</td>\n      <td>1538.0000</td>\n      <td>3081.0000</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>cost per year</td>\n      <td>4580.0000</td>\n      <td>5875.0000</td>\n      <td>7064.0000</td>\n      <td>5617.0000</td>\n      <td>6845.0000</td>\n      <td>6835.0000</td>\n      <td>7173.0000</td>\n      <td>5717.0000</td>\n      <td>6782.0000</td>\n      <td>6201.0000</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>total cost per year</td>\n      <td>7114.0000</td>\n      <td>8643.0000</td>\n      <td>10403.0000</td>\n      <td>8394.0000</td>\n      <td>10265.0000</td>\n      <td>10036.0000</td>\n      <td>10839.0000</td>\n      <td>7736.0000</td>\n      <td>8320.0000</td>\n      <td>9282.0000</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>total cost per day</td>\n      <td>19.4900</td>\n      <td>23.6800</td>\n      <td>28.5000</td>\n      <td>23.0000</td>\n      <td>28.1200</td>\n      <td>27.5000</td>\n      <td>29.7000</td>\n      <td>21.1900</td>\n      <td>22.7900</td>\n      <td>25.4300</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>total cost per mile</td>\n      <td>0.4742</td>\n      <td>0.5762</td>\n      <td>0.6935</td>\n      <td>0.5596</td>\n      <td>0.6843</td>\n      <td>0.6691</td>\n      <td>0.7226</td>\n      <td>0.5157</td>\n      <td>0.5546</td>\n      <td>0.6188</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Total Cost per Mile - 20k mi/yr</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>cost per mile driven</td>\n      <td>3378.0000</td>\n      <td>3690.0000</td>\n      <td>4452.0000</td>\n      <td>3702.0000</td>\n      <td>4560.0000</td>\n      <td>4268.0000</td>\n      <td>4888.0000</td>\n      <td>2692.0000</td>\n      <td>2050.0000</td>\n      <td>4108.0000</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>cost per year</td>\n      <td>4580.0000</td>\n      <td>5875.0000</td>\n      <td>7064.0000</td>\n      <td>5617.0000</td>\n      <td>6845.0000</td>\n      <td>6835.0000</td>\n      <td>7173.0000</td>\n      <td>5717.0000</td>\n      <td>6782.0000</td>\n      <td>6201.0000</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>depreciation</td>\n      <td>227.0000</td>\n      <td>252.0000</td>\n      <td>320.0000</td>\n      <td>310.0000</td>\n      <td>414.0000</td>\n      <td>286.0000</td>\n      <td>496.0000</td>\n      <td>285.0000</td>\n      <td>338.0000</td>\n      <td>354.0000</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>total cost per year</td>\n      <td>8185.0000</td>\n      <td>9817.0000</td>\n      <td>11836.0000</td>\n      <td>9629.0000</td>\n      <td>11819.0000</td>\n      <td>11389.0000</td>\n      <td>12557.0000</td>\n      <td>8694.0000</td>\n      <td>9170.0000</td>\n      <td>10663.0000</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>cost per day</td>\n      <td>22.4200</td>\n      <td>26.9000</td>\n      <td>32.4300</td>\n      <td>26.3800</td>\n      <td>32.3800</td>\n      <td>31.2000</td>\n      <td>34.4000</td>\n      <td>23.8200</td>\n      <td>25.1200</td>\n      <td>29.2100</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>cost per mile</td>\n      <td>0.4093</td>\n      <td>0.4909</td>\n      <td>0.5918</td>\n      <td>0.4815</td>\n      <td>0.5910</td>\n      <td>0.5695</td>\n      <td>0.6279</td>\n      <td>0.4347</td>\n      <td>0.4585</td>\n      <td>0.5331</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Intermediate Cost Calculations\n\n### Transportation Expenditures\n\n#### Create Dataframe\n\n::: {#00ea40aa .cell execution_count=22}\n``` {.python .cell-code}\n# Define year range\nyear_range = list(range(1990, 2021)) # Last year should be one more than desired\n\n# Ensure column names are strings in both DataFrames to avoid indexing issues\ndf_PersonalExpenditure.columns = df_PersonalExpenditure.columns.astype(str)\ndf_AverageCost.columns = df_AverageCost.columns.astype(str)\n\n# Create a DataFrame to combine the extracted data\ndf_TransportationExpenditure = pd.DataFrame({\n    # The years from 1990 to 2020\n    \"Year\": year_range,\n    # Extract the 'Transportation Cost Percent of Total' for the years 1990-2020 from row 2\n    \"Transportation Percent of Total\": pd.to_numeric(\n      df_PersonalExpenditure.loc[2, str(year_range[0]):str(year_range[-1])].values,\n      errors=\"coerce\"\n    ),\n    # Extract the 'Gasoline Cost of Transportation' for the years 1990-2020 from row 2\n    \"Gasoline Cost of Transportation\": pd.to_numeric(\n      df_AverageCost.loc[2, str(year_range[0]):str(year_range[-1])].values,\n      errors=\"coerce\"\n    )\n})\n\n# FIXME: Did not understand the logic for this\ndf_TransportationExpenditure[\"Gasoline Percent of Total\"] = df_TransportationExpenditure[\"Gasoline Cost of Transportation\"] * df_TransportationExpenditure[\"Transportation Percent of Total\"] / 100\n\ndf_TransportationExpenditure\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Transportation Percent of Total</th>\n      <th>Gasoline Cost of Transportation</th>\n      <th>Gasoline Percent of Total</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1990</td>\n      <td>11.628556</td>\n      <td>16.350424</td>\n      <td>1.901318</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1991</td>\n      <td>10.606806</td>\n      <td>17.675415</td>\n      <td>1.874797</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1992</td>\n      <td>10.751129</td>\n      <td>15.195742</td>\n      <td>1.633714</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993</td>\n      <td>10.893301</td>\n      <td>15.248105</td>\n      <td>1.661022</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994</td>\n      <td>11.169433</td>\n      <td>14.198783</td>\n      <td>1.585923</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1995</td>\n      <td>11.132856</td>\n      <td>14.066289</td>\n      <td>1.565980</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1996</td>\n      <td>11.376777</td>\n      <td>13.147597</td>\n      <td>1.495773</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1997</td>\n      <td>11.546636</td>\n      <td>14.725569</td>\n      <td>1.700308</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1998</td>\n      <td>11.334744</td>\n      <td>13.462652</td>\n      <td>1.525957</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1999</td>\n      <td>11.557797</td>\n      <td>11.914894</td>\n      <td>1.377099</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2000</td>\n      <td>11.720039</td>\n      <td>14.056770</td>\n      <td>1.647459</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2001</td>\n      <td>11.388149</td>\n      <td>15.482101</td>\n      <td>1.763125</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2002</td>\n      <td>10.978874</td>\n      <td>11.746748</td>\n      <td>1.289661</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2003</td>\n      <td>10.853123</td>\n      <td>13.928295</td>\n      <td>1.511655</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2004</td>\n      <td>10.858119</td>\n      <td>11.564464</td>\n      <td>1.255683</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2005</td>\n      <td>10.893612</td>\n      <td>14.625446</td>\n      <td>1.593239</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2006</td>\n      <td>10.648980</td>\n      <td>18.189941</td>\n      <td>1.937043</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2007</td>\n      <td>10.547746</td>\n      <td>17.065065</td>\n      <td>1.799980</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2008</td>\n      <td>10.119130</td>\n      <td>21.555227</td>\n      <td>2.181202</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2009</td>\n      <td>8.894102</td>\n      <td>18.694417</td>\n      <td>1.662700</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2010</td>\n      <td>9.373626</td>\n      <td>20.077766</td>\n      <td>1.882015</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2011</td>\n      <td>10.097593</td>\n      <td>21.091613</td>\n      <td>2.129745</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2012</td>\n      <td>10.278172</td>\n      <td>23.759222</td>\n      <td>2.442014</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2013</td>\n      <td>10.300199</td>\n      <td>23.761237</td>\n      <td>2.447455</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2014</td>\n      <td>10.145703</td>\n      <td>21.969356</td>\n      <td>2.228946</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2015</td>\n      <td>9.489218</td>\n      <td>19.332030</td>\n      <td>1.834459</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2016</td>\n      <td>9.163512</td>\n      <td>14.810703</td>\n      <td>1.357181</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2017</td>\n      <td>9.315180</td>\n      <td>18.174303</td>\n      <td>1.692969</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2018</td>\n      <td>9.467568</td>\n      <td>18.730930</td>\n      <td>1.773364</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2019</td>\n      <td>9.193706</td>\n      <td>18.745960</td>\n      <td>1.723448</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2020</td>\n      <td>8.068630</td>\n      <td>16.724192</td>\n      <td>1.349413</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n::: {#1b113c75 .cell execution_count=23}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Transportation Cost Percent of Total with a blue line\nsns.lineplot(data=df_TransportationExpenditure, x='Year', y='Transportation Percent of Total',\n             color='#0070C0', linewidth=2.5, label='Transportation as % of Total Expenditure')\n\n# Plot Gasoline Percent of Total with a red line\nsns.lineplot(data=df_TransportationExpenditure, x='Year', y='Gasoline Percent of Total',\n             color='#FF0000', linewidth=2.5, label='Gasoline as % of Total Expenditure')\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_TransportationExpenditure, x='Year', y='Transportation Percent of Total',\n            scatter=False, color='#0070C0', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\nsns.regplot(data=df_TransportationExpenditure, x='Year', y='Gasoline Percent of Total',\n            scatter=False, color='#FF0000', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Customize the plot\nplt.title('Transportation as a Percent of Total Expenditure',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('% of Total Expenditure', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_TransportationExpenditure['Year'], rotation=90)\n\nplt.legend(loc='upper right', fontsize=11)\n\n# Set y-axis limits to extend to 14\nplt.ylim(0, 14)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-24-output-1.png){width=949 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n::: {#7589bc32 .cell execution_count=24}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ndf_TranspExp_Comparision = pd.DataFrame({\n    'Date': [2019, 2019],\n    'Actual': [\n        df_TransportationExpenditure.loc[df_TransportationExpenditure['Year'] == 2019, 'Transportation Percent of Total'].iloc[0],\n        df_TransportationExpenditure.loc[df_TransportationExpenditure['Year'] == 2019, 'Gasoline Percent of Total'].iloc[0]  # FIXED: THere is a potential error here in Excel sheet\n    ],\n    'Trend': [\n        np.poly1d(np.polyfit(pd.to_numeric(df_TransportationExpenditure['Year']),\n                            pd.to_numeric(df_TransportationExpenditure['Transportation Percent of Total']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_TransportationExpenditure['Year']),\n                            pd.to_numeric(df_TransportationExpenditure['Gasoline Percent of Total']), 1))(2019)\n    ]\n}, index=['Transportation as % Total Expenditures', 'Gasoline as % Total Expenditures']).round(2)\n\ndf_TranspExp_Comparision\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Actual</th>\n      <th>Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Transportation as % Total Expenditures</th>\n      <td>2019</td>\n      <td>9.19</td>\n      <td>9.26</td>\n    </tr>\n    <tr>\n      <th>Gasoline as % Total Expenditures</th>\n      <td>2019</td>\n      <td>1.72</td>\n      <td>1.85</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Auto Cost - Variable-Fixed\n\n#### Create Dataframe\n\n::: {#10a1f2a4 .cell execution_count=25}\n``` {.python .cell-code}\n# Define year range\nyear_range = list(range(1990, 2021))  # Last year should be one more than desired\n\n# Compile data from Raw Datasets\ndf_AutoCost_VariableFixed = pd.DataFrame({\n    \"Year\": year_range,\n    \"Variable\": pd.to_numeric(\n      df_AverageCost.loc[6, str(year_range[0]):str(year_range[-1])].values,\n      errors=\"coerce\"\n    ),\n    \"Fixed\": pd.to_numeric(\n      df_AverageCost.loc[7, str(year_range[0]):str(year_range[-1])].values,\n      errors=\"coerce\"\n    ),\n    \"Total\": pd.to_numeric(\n      df_AverageCost.loc[5, str(year_range[0]):str(year_range[-1])].values,\n      errors=\"coerce\"\n    ),\n    \"CPI\": pd.to_numeric(\n      df_CPI[df_CPI['Year'].between(year_range[0], year_range[-1])][\"Avg.\"].values,\n      errors=\"coerce\"\n    )\n})\n\n# Create Derived Columns\ndf_AutoCost_VariableFixed[\"Per 15k\"] = df_AutoCost_VariableFixed[\"Fixed\"] / 15000\ndf_AutoCost_VariableFixed[\"Variable/Total\"] = df_AutoCost_VariableFixed[\"Variable\"] / df_AutoCost_VariableFixed[\"Total\"]\ndf_AutoCost_VariableFixed[\"Variable/CPI\"] = df_AutoCost_VariableFixed[\"Variable\"] / df_AutoCost_VariableFixed[\"CPI\"]\ndf_AutoCost_VariableFixed[\"Fixed/CPI\"] = df_AutoCost_VariableFixed[\"Fixed\"] / df_AutoCost_VariableFixed[\"CPI\"]\n\n# Reorder columns\ndf_AutoCost_VariableFixed = df_AutoCost_VariableFixed[['Year', 'Variable/Total', 'Variable/CPI', 'Fixed/CPI', 'Variable', 'Fixed', 'Total', 'Per 15k', 'CPI']]\n\ndf_AutoCost_VariableFixed\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Variable/Total</th>\n      <th>Variable/CPI</th>\n      <th>Fixed/CPI</th>\n      <th>Variable</th>\n      <th>Fixed</th>\n      <th>Total</th>\n      <th>Per 15k</th>\n      <th>CPI</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1990</td>\n      <td>0.254340</td>\n      <td>9.640398</td>\n      <td>28.263198</td>\n      <td>1260.0</td>\n      <td>3694.0</td>\n      <td>4954.0</td>\n      <td>0.246267</td>\n      <td>130.700</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1991</td>\n      <td>0.259775</td>\n      <td>10.682819</td>\n      <td>30.440529</td>\n      <td>1455.0</td>\n      <td>4146.0</td>\n      <td>5601.0</td>\n      <td>0.276400</td>\n      <td>136.200</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1992</td>\n      <td>0.231799</td>\n      <td>9.622238</td>\n      <td>31.888810</td>\n      <td>1350.0</td>\n      <td>4474.0</td>\n      <td>5824.0</td>\n      <td>0.298267</td>\n      <td>140.300</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993</td>\n      <td>0.237767</td>\n      <td>9.550173</td>\n      <td>30.615917</td>\n      <td>1380.0</td>\n      <td>4424.0</td>\n      <td>5804.0</td>\n      <td>0.294933</td>\n      <td>144.500</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994</td>\n      <td>0.230730</td>\n      <td>9.210526</td>\n      <td>30.708502</td>\n      <td>1365.0</td>\n      <td>4551.0</td>\n      <td>5916.0</td>\n      <td>0.303400</td>\n      <td>148.200</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1995</td>\n      <td>0.232821</td>\n      <td>9.448819</td>\n      <td>31.135171</td>\n      <td>1440.0</td>\n      <td>4745.0</td>\n      <td>6185.0</td>\n      <td>0.316333</td>\n      <td>152.400</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1996</td>\n      <td>0.225387</td>\n      <td>9.177820</td>\n      <td>31.542384</td>\n      <td>1440.0</td>\n      <td>4949.0</td>\n      <td>6389.0</td>\n      <td>0.329933</td>\n      <td>156.900</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1997</td>\n      <td>0.240964</td>\n      <td>10.093458</td>\n      <td>31.794393</td>\n      <td>1620.0</td>\n      <td>5103.0</td>\n      <td>6723.0</td>\n      <td>0.340200</td>\n      <td>160.500</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1998</td>\n      <td>0.232339</td>\n      <td>9.846626</td>\n      <td>32.533742</td>\n      <td>1605.0</td>\n      <td>5303.0</td>\n      <td>6908.0</td>\n      <td>0.353533</td>\n      <td>163.000</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1999</td>\n      <td>0.225532</td>\n      <td>9.543818</td>\n      <td>32.773109</td>\n      <td>1590.0</td>\n      <td>5460.0</td>\n      <td>7050.0</td>\n      <td>0.364000</td>\n      <td>166.600</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2000</td>\n      <td>0.248404</td>\n      <td>10.621370</td>\n      <td>32.137050</td>\n      <td>1829.0</td>\n      <td>5534.0</td>\n      <td>7363.0</td>\n      <td>0.368933</td>\n      <td>172.200</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2001</td>\n      <td>0.266527</td>\n      <td>11.518916</td>\n      <td>31.699605</td>\n      <td>2040.0</td>\n      <td>5614.0</td>\n      <td>7654.0</td>\n      <td>0.374267</td>\n      <td>177.100</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2002</td>\n      <td>0.234935</td>\n      <td>9.838799</td>\n      <td>32.040022</td>\n      <td>1770.0</td>\n      <td>5764.0</td>\n      <td>7534.0</td>\n      <td>0.384267</td>\n      <td>179.900</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2003</td>\n      <td>0.253418</td>\n      <td>10.679348</td>\n      <td>31.461957</td>\n      <td>1965.0</td>\n      <td>5789.0</td>\n      <td>7754.0</td>\n      <td>0.385933</td>\n      <td>184.000</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2004</td>\n      <td>0.224173</td>\n      <td>10.005294</td>\n      <td>34.626787</td>\n      <td>1890.0</td>\n      <td>6541.0</td>\n      <td>8431.0</td>\n      <td>0.436067</td>\n      <td>188.900</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2005</td>\n      <td>0.251486</td>\n      <td>10.829493</td>\n      <td>32.232463</td>\n      <td>2115.0</td>\n      <td>6295.0</td>\n      <td>8410.0</td>\n      <td>0.419667</td>\n      <td>195.300</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2006</td>\n      <td>0.289124</td>\n      <td>11.235119</td>\n      <td>27.624008</td>\n      <td>2265.0</td>\n      <td>5569.0</td>\n      <td>7834.0</td>\n      <td>0.371267</td>\n      <td>201.600</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2007</td>\n      <td>0.278026</td>\n      <td>10.489915</td>\n      <td>27.240019</td>\n      <td>2175.0</td>\n      <td>5648.0</td>\n      <td>7823.0</td>\n      <td>0.376533</td>\n      <td>207.342</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2008</td>\n      <td>0.313385</td>\n      <td>11.820551</td>\n      <td>25.898385</td>\n      <td>2545.0</td>\n      <td>5576.0</td>\n      <td>8121.0</td>\n      <td>0.371733</td>\n      <td>215.303</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2009</td>\n      <td>0.285697</td>\n      <td>10.781357</td>\n      <td>26.955723</td>\n      <td>2313.0</td>\n      <td>5783.0</td>\n      <td>8096.0</td>\n      <td>0.385533</td>\n      <td>214.537</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2010</td>\n      <td>0.295864</td>\n      <td>11.515391</td>\n      <td>27.405804</td>\n      <td>2511.0</td>\n      <td>5976.0</td>\n      <td>8487.0</td>\n      <td>0.398400</td>\n      <td>218.056</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2011</td>\n      <td>0.303327</td>\n      <td>11.834320</td>\n      <td>27.180702</td>\n      <td>2662.0</td>\n      <td>6114.0</td>\n      <td>8776.0</td>\n      <td>0.407600</td>\n      <td>224.939</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2012</td>\n      <td>0.329309</td>\n      <td>12.831346</td>\n      <td>26.133087</td>\n      <td>2946.0</td>\n      <td>6000.0</td>\n      <td>8946.0</td>\n      <td>0.400000</td>\n      <td>229.594</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2013</td>\n      <td>0.335891</td>\n      <td>13.152642</td>\n      <td>26.004799</td>\n      <td>3064.0</td>\n      <td>6058.0</td>\n      <td>9122.0</td>\n      <td>0.403867</td>\n      <td>232.957</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2014</td>\n      <td>0.321654</td>\n      <td>12.059847</td>\n      <td>25.433394</td>\n      <td>2855.0</td>\n      <td>6021.0</td>\n      <td>8876.0</td>\n      <td>0.401400</td>\n      <td>236.736</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2015</td>\n      <td>0.298459</td>\n      <td>10.952801</td>\n      <td>25.744989</td>\n      <td>2596.0</td>\n      <td>6102.0</td>\n      <td>8698.0</td>\n      <td>0.406800</td>\n      <td>237.017</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2016</td>\n      <td>0.258004</td>\n      <td>9.199732</td>\n      <td>26.457562</td>\n      <td>2208.0</td>\n      <td>6350.0</td>\n      <td>8558.0</td>\n      <td>0.423333</td>\n      <td>240.007</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2017</td>\n      <td>0.321918</td>\n      <td>11.121084</td>\n      <td>23.425261</td>\n      <td>2726.0</td>\n      <td>5742.0</td>\n      <td>8468.0</td>\n      <td>0.382800</td>\n      <td>245.120</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2018</td>\n      <td>0.326478</td>\n      <td>11.505056</td>\n      <td>23.734902</td>\n      <td>2889.0</td>\n      <td>5960.0</td>\n      <td>8849.0</td>\n      <td>0.397333</td>\n      <td>251.107</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2019</td>\n      <td>0.331933</td>\n      <td>12.051303</td>\n      <td>24.255154</td>\n      <td>3081.0</td>\n      <td>6201.0</td>\n      <td>9282.0</td>\n      <td>0.413400</td>\n      <td>255.657</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2020</td>\n      <td>0.310428</td>\n      <td>11.467828</td>\n      <td>25.474188</td>\n      <td>2968.0</td>\n      <td>6593.0</td>\n      <td>9561.0</td>\n      <td>0.439533</td>\n      <td>258.811</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n##### Fixed/CPI and Variable/CPI\n\n::: {#64f9d22c .cell execution_count=26}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Create smooth spline curves\nx = df_AutoCost_VariableFixed['Year']\ny_fixed = df_AutoCost_VariableFixed['Fixed/CPI']\ny_variable = df_AutoCost_VariableFixed['Variable/CPI']\n\n# Generate smooth curves\nx_smooth = np.linspace(x.min(), x.max(), 300)\nspline_fixed = make_interp_spline(x, y_fixed, k=3)\nspline_variable = make_interp_spline(x, y_variable, k=3)\n\ny_fixed_smooth = spline_fixed(x_smooth)\ny_variable_smooth = spline_variable(x_smooth)\n\n# Plot smooth lines\nsns.lineplot(x=x_smooth, y=y_fixed_smooth, linewidth=2.5, color=\"#00B050\", label=\"Fixed/CPI\")\nsns.lineplot(x=x_smooth, y=y_variable_smooth, linewidth=2.5, color=\"#FF0000\", label=\"Variable/CPI\")\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.0f}'))\n\n# Customize the plot\nplt.title('Trendline of Fixed/CPI and Variable/CPI (1990–2020)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('Value', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_AutoCost_VariableFixed['Year'], rotation=90)\n\nplt.legend(loc='upper right', fontsize=11)\n\n# Set y-axis limits to extend to $40\nplt.ylim(0, 40)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-27-output-1.png){width=949 height=566}\n:::\n:::\n\n\n##### Average Cost per Mile\n\n::: {#d80406f3 .cell execution_count=27}\n``` {.python .cell-code}\n# Create the stacked area plot\nplt.figure(figsize=(10, 6))\n\n# Stack the areas - Fixed on bottom, Variable on top\nplt.fill_between(df_AutoCost_VariableFixed['Year'],\n                 0,\n                 df_AutoCost_VariableFixed['Fixed'],\n                 color='#9BBB59',\n                 label='Fixed')\n\nplt.fill_between(df_AutoCost_VariableFixed['Year'],\n                 df_AutoCost_VariableFixed['Fixed'],\n                 df_AutoCost_VariableFixed['Fixed'] + df_AutoCost_VariableFixed['Variable'],\n                 color='#C0504D',\n                 label='Variable')\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.0f}'))\n\n# Customize the plot\nplt.title('Average Total Cost per 15,000 Miles',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('USDs', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_AutoCost_VariableFixed['Year'], rotation=90)\n\nplt.legend(loc='upper left', fontsize=11)\n\n# Set y-axis limits\nplt.ylim(0, 10000)\n\n# Add grid\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-28-output-1.png){width=950 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n::: {#6809c81e .cell execution_count=28}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ndf_AutoCost_VariableFixed_Comparision = pd.DataFrame({\n    'Date': [2019, 2019, 2019],\n    'Actual': [\n        df_AutoCost_VariableFixed.loc[df_AutoCost_VariableFixed['Year'] == 2019, 'Variable'].iloc[0],\n        df_AutoCost_VariableFixed.loc[df_AutoCost_VariableFixed['Year'] == 2019, 'Fixed'].iloc[0],\n        df_AutoCost_VariableFixed.loc[df_AutoCost_VariableFixed['Year'] == 2019, 'Per 15k'].iloc[0]\n    ],\n    'Trend': [\n        np.poly1d(np.polyfit(pd.to_numeric(df_AutoCost_VariableFixed['Year']),\n                            pd.to_numeric(df_AutoCost_VariableFixed['Variable']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_AutoCost_VariableFixed['Year']),\n                            pd.to_numeric(df_AutoCost_VariableFixed['Fixed']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_AutoCost_VariableFixed['Year']),\n                            pd.to_numeric(df_AutoCost_VariableFixed['Per 15k']), 1))(2019)\n    ]\n}, index=['Variable', 'Fixed', 'Fixed per 15,000 Miles']).round(2)\n\ndf_AutoCost_VariableFixed_Comparision\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Actual</th>\n      <th>Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Variable</th>\n      <td>2019</td>\n      <td>3081.00</td>\n      <td>2990.68</td>\n    </tr>\n    <tr>\n      <th>Fixed</th>\n      <td>2019</td>\n      <td>6201.00</td>\n      <td>6498.80</td>\n    </tr>\n    <tr>\n      <th>Fixed per 15,000 Miles</th>\n      <td>2019</td>\n      <td>0.41</td>\n      <td>0.43</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Auto Cost\n\n#### Create Dataframe\n\n::: {#af766d65 .cell execution_count=29}\n``` {.python .cell-code}\n# Define year range\nyear_range = list(range(1990, 2021)) # Last year should be one more than desired\n\n# Ensure column names are strings in both DataFrames to avoid indexing issues\ndf_AverageCost.columns = df_AverageCost.columns.astype(str)\n\n# Compile data from Raw Datasets\ndf_AutoCost = pd.DataFrame({\n    \"Year\": year_range,\n    \"Gas\": pd.to_numeric(\n        df_AverageCost.loc[1, str(year_range[0]):str(year_range[-1])].values,\n        errors=\"coerce\"\n    ),\n    \"Maint\": pd.to_numeric(\n        df_AverageCost.loc[3, str(year_range[0]):str(year_range[-1])].values,\n        errors=\"coerce\"\n    ),\n    \"Tires\": pd.to_numeric(\n        df_AverageCost.loc[4, str(year_range[0]):str(year_range[-1])].values,\n        errors=\"coerce\"   # turns \"U\" into NaN\n    )\n})\n\ndf_AutoCost[\"Maint+Tires\"] = df_AutoCost[\"Maint\"].fillna(0) + df_AutoCost[\"Tires\"].fillna(0)\n\n# View Dataframe\ndf_AutoCost\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Gas</th>\n      <th>Maint</th>\n      <th>Tires</th>\n      <th>Maint+Tires</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1990</td>\n      <td>5.40</td>\n      <td>2.10</td>\n      <td>0.90</td>\n      <td>3.00</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1991</td>\n      <td>6.60</td>\n      <td>2.20</td>\n      <td>0.90</td>\n      <td>3.10</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1992</td>\n      <td>5.90</td>\n      <td>2.20</td>\n      <td>0.90</td>\n      <td>3.10</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993</td>\n      <td>5.90</td>\n      <td>2.40</td>\n      <td>0.90</td>\n      <td>3.30</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994</td>\n      <td>5.60</td>\n      <td>2.50</td>\n      <td>1.00</td>\n      <td>3.50</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1995</td>\n      <td>5.80</td>\n      <td>2.60</td>\n      <td>1.20</td>\n      <td>3.80</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1996</td>\n      <td>5.60</td>\n      <td>2.80</td>\n      <td>1.20</td>\n      <td>4.00</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1997</td>\n      <td>6.60</td>\n      <td>2.80</td>\n      <td>1.40</td>\n      <td>4.20</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1998</td>\n      <td>6.20</td>\n      <td>3.10</td>\n      <td>1.40</td>\n      <td>4.50</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1999</td>\n      <td>5.60</td>\n      <td>3.30</td>\n      <td>1.70</td>\n      <td>5.00</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2000</td>\n      <td>6.90</td>\n      <td>3.60</td>\n      <td>1.70</td>\n      <td>5.30</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2001</td>\n      <td>7.90</td>\n      <td>3.90</td>\n      <td>1.80</td>\n      <td>5.70</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2002</td>\n      <td>5.90</td>\n      <td>4.10</td>\n      <td>1.80</td>\n      <td>5.90</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2003</td>\n      <td>7.20</td>\n      <td>4.10</td>\n      <td>1.80</td>\n      <td>5.90</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2004</td>\n      <td>6.50</td>\n      <td>5.40</td>\n      <td>0.70</td>\n      <td>6.10</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2005</td>\n      <td>8.20</td>\n      <td>5.30</td>\n      <td>0.60</td>\n      <td>5.90</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2006</td>\n      <td>9.50</td>\n      <td>4.90</td>\n      <td>0.70</td>\n      <td>5.60</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2007</td>\n      <td>8.90</td>\n      <td>4.90</td>\n      <td>0.70</td>\n      <td>5.60</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2008</td>\n      <td>11.67</td>\n      <td>4.57</td>\n      <td>0.72</td>\n      <td>5.29</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2009</td>\n      <td>10.09</td>\n      <td>4.56</td>\n      <td>0.77</td>\n      <td>5.33</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2010</td>\n      <td>11.36</td>\n      <td>4.54</td>\n      <td>0.83</td>\n      <td>5.37</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2011</td>\n      <td>12.34</td>\n      <td>4.44</td>\n      <td>0.96</td>\n      <td>5.40</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2012</td>\n      <td>14.17</td>\n      <td>4.47</td>\n      <td>1.00</td>\n      <td>5.47</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2013</td>\n      <td>14.45</td>\n      <td>4.97</td>\n      <td>1.00</td>\n      <td>5.97</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2014</td>\n      <td>13.00</td>\n      <td>5.06</td>\n      <td>0.97</td>\n      <td>6.03</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2015</td>\n      <td>11.21</td>\n      <td>5.11</td>\n      <td>0.98</td>\n      <td>6.09</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2016</td>\n      <td>8.45</td>\n      <td>5.28</td>\n      <td>1.00</td>\n      <td>6.28</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2017</td>\n      <td>10.26</td>\n      <td>7.91</td>\n      <td>NaN</td>\n      <td>7.91</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2018</td>\n      <td>11.05</td>\n      <td>8.21</td>\n      <td>NaN</td>\n      <td>8.21</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2019</td>\n      <td>11.60</td>\n      <td>8.94</td>\n      <td>NaN</td>\n      <td>8.94</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2020</td>\n      <td>10.66</td>\n      <td>9.12</td>\n      <td>NaN</td>\n      <td>9.12</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n::: {#3c062eab .cell execution_count=30}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Fixed/CPI with a green line\nsns.lineplot(data=df_AutoCost, x=\"Year\", y=\"Gas\",\nlinewidth=2.5, color=\"#0070C0\", label=\"Gas\")\n\n# Plot Variable/CPI with a red line\nsns.lineplot(data=df_AutoCost, x=\"Year\", y=\"Maint+Tires\",\nlinewidth=2.5,color=\"#FF0000\", label=\"Maint+Tires\")\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_AutoCost, x='Year', y='Gas',\n            scatter=False, color='#0070C0', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\nsns.regplot(data=df_AutoCost, x='Year', y='Maint+Tires',\n            scatter=False, color='#FF0000', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Average Auto Costs',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('USDs', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_AutoCost['Year'], rotation=90)\n\nplt.legend(loc='upper left', fontsize=11)\n\n# Set y-axis limits to extend to 16\nplt.ylim(0, 16)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-31-output-1.png){width=949 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n::: {#27015e5e .cell execution_count=31}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ndf_AutoCost_Comparision = pd.DataFrame({\n    'Date': [2019, 2019],\n    'Actual': [\n        df_AutoCost.loc[df_AutoCost['Year'] == 2019, 'Gas'].iloc[0],\n        df_AutoCost.loc[df_AutoCost['Year'] == 2019, 'Maint+Tires'].iloc[0]\n    ],\n    'Trend': [\n        np.poly1d(np.polyfit(pd.to_numeric(df_AutoCost['Year']),\n                            pd.to_numeric(df_AutoCost['Gas']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_AutoCost['Year']),\n                            pd.to_numeric(df_AutoCost['Maint+Tires']), 1))(2019)\n    ]\n}, index=['Gas', 'Maint+Tires']).round(2)\n\ndf_AutoCost_Comparision\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Actual</th>\n      <th>Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Gas</th>\n      <td>2019</td>\n      <td>11.60</td>\n      <td>12.31</td>\n    </tr>\n    <tr>\n      <th>Maint+Tires</th>\n      <td>2019</td>\n      <td>8.94</td>\n      <td>7.63</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Vehicle Miles - Trucks\n\n#### Create Dataframe\n\n::: {#951651f3 .cell execution_count=32}\n``` {.python .cell-code}\n# Define year range\nyear_range = list(range(1990, 2020)) # Last year should be one more than desired\n\n# Ensure column names are strings in both DataFrames to avoid indexing issues\ndf_FE_Heavy.columns = df_FE_Heavy.columns.astype(str)\ndf_FE_Medium.columns = df_FE_Medium.columns.astype(str)\ndf_4_11.columns = df_4_11.columns.astype(str)\n\n# Compile data from Raw Datasets\ndf_VehicleMiles_Truck = pd.DataFrame({\n  \"Year\": year_range,\n  \"Heavy\": pd.to_numeric(\n    df_FE_Heavy.loc[3, str(year_range[0]):str(year_range[-1])].values,\n    errors=\"coerce\"\n  ),\n  \"Medium\": pd.to_numeric(\n    df_FE_Medium.loc[3, str(year_range[0]):str(year_range[-1])].values,\n    errors=\"coerce\"\n  ),\n  \"Light\": pd.to_numeric(\n    df_4_11.loc[10, str(year_range[0]):str(year_range[-1])].values,\n    errors=\"coerce\"\n  )\n})\n\n# View dataframe\ndf_VehicleMiles_Truck\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Heavy</th>\n      <th>Medium</th>\n      <th>Light</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1990</td>\n      <td>55.205896</td>\n      <td>11.567039</td>\n      <td>10.604470</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1991</td>\n      <td>57.141114</td>\n      <td>11.805424</td>\n      <td>10.657580</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1992</td>\n      <td>59.395982</td>\n      <td>12.328648</td>\n      <td>10.910993</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1993</td>\n      <td>61.367245</td>\n      <td>12.879855</td>\n      <td>10.874463</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994</td>\n      <td>69.000815</td>\n      <td>12.971235</td>\n      <td>11.210377</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1995</td>\n      <td>68.082519</td>\n      <td>12.481911</td>\n      <td>11.202821</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1996</td>\n      <td>68.222714</td>\n      <td>12.167043</td>\n      <td>11.322535</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1997</td>\n      <td>69.601244</td>\n      <td>12.637158</td>\n      <td>11.580509</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1998</td>\n      <td>64.264812</td>\n      <td>11.860835</td>\n      <td>11.753597</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1999</td>\n      <td>65.261008</td>\n      <td>12.200704</td>\n      <td>11.849625</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2000</td>\n      <td>64.398920</td>\n      <td>11.896666</td>\n      <td>11.976276</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2001</td>\n      <td>63.381121</td>\n      <td>12.692860</td>\n      <td>11.823908</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2002</td>\n      <td>60.938805</td>\n      <td>13.426140</td>\n      <td>12.201779</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2003</td>\n      <td>73.428301</td>\n      <td>13.293659</td>\n      <td>12.323788</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2004</td>\n      <td>70.819043</td>\n      <td>12.731804</td>\n      <td>12.459739</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2005</td>\n      <td>69.019949</td>\n      <td>12.274076</td>\n      <td>12.509663</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2006</td>\n      <td>65.525633</td>\n      <td>12.083042</td>\n      <td>12.485488</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2007</td>\n      <td>69.895569</td>\n      <td>14.781778</td>\n      <td>10.709976</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2008</td>\n      <td>71.106154</td>\n      <td>15.305740</td>\n      <td>10.290338</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2009</td>\n      <td>64.230789</td>\n      <td>14.385515</td>\n      <td>10.391369</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2010</td>\n      <td>68.859486</td>\n      <td>13.476414</td>\n      <td>10.650447</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2011</td>\n      <td>66.808917</td>\n      <td>13.275650</td>\n      <td>11.150028</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2012</td>\n      <td>66.259827</td>\n      <td>12.893960</td>\n      <td>11.261705</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2013</td>\n      <td>68.155349</td>\n      <td>13.116107</td>\n      <td>11.243638</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2014</td>\n      <td>65.897234</td>\n      <td>13.123373</td>\n      <td>11.047811</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2015</td>\n      <td>61.978009</td>\n      <td>12.960431</td>\n      <td>11.327179</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2016</td>\n      <td>63.428143</td>\n      <td>12.958064</td>\n      <td>11.369575</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2017</td>\n      <td>62.751211</td>\n      <td>12.434660</td>\n      <td>11.466791</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2018</td>\n      <td>63.373855</td>\n      <td>11.686694</td>\n      <td>11.576437</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2019</td>\n      <td>59.928929</td>\n      <td>12.277598</td>\n      <td>11.599293</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n##### 1990 - 2019\n\n::: {#77340b3e .cell execution_count=33}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Variable with a red line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Heavy\",\nlinewidth=2.5,color=\"#0070C0\", label=\"Heavy\")\n\n# Plot Variable with a red line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Medium\",\nlinewidth=2.5,color=\"#BE4B48\", label=\"Medium\")\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Light\",\nlinewidth=2.5, color=\"#98B954\", label=\"Light\")\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_VehicleMiles_Truck, x='Year', y='Heavy',\n            scatter=False, color='#0070C0', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Customize the plot\nplt.title('Average Vehicle Miles - Trucks (1990 - 2019)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('Miles', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_VehicleMiles_Truck['Year'], rotation=90)\n\nplt.legend(loc='upper left', fontsize=11)\n\n# Set y-axis limits to extend to 80\nplt.ylim(0, 80)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-34-output-1.png){width=949 height=566}\n:::\n:::\n\n\n##### 2000 - 2019\n\n::: {#51727db5 .cell execution_count=34}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Variable with a red line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Heavy\",\nlinewidth=2.5,color=\"#0070C0\", label=\"Heavy\")\n\n# Plot Variable with a red line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Medium\",\nlinewidth=2.5,color=\"#BE4B48\", label=\"Medium\")\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_VehicleMiles_Truck, x=\"Year\", y=\"Light\",\nlinewidth=2.5, color=\"#00B050\", label=\"Light\")\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_VehicleMiles_Truck, x='Year', y='Heavy',\n            scatter=False, color='#0070C0', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_VehicleMiles_Truck, x='Year', y='Medium',\n            scatter=False, color='#FF0000', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_VehicleMiles_Truck, x='Year', y='Light',\n            scatter=False, color='#00B050', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Customize the plot\nplt.title('Average Vehicle Miles - Trucks (2000 - 2019)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('Miles', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_VehicleMiles_Truck['Year'], rotation=90)\n\nplt.legend(loc='upper left', fontsize=11)\n\n# Set x-axis limits to show only 2000-2019\nplt.xlim(2000, 2019)\n\n# Set y-axis limits to extend to 80\nplt.ylim(0, 80)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-35-output-1.png){width=949 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n::: {#c05ab164 .cell execution_count=35}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ndf_VMTrucks_Comparision = pd.DataFrame({\n    'Date': [2019, 2019, 2019, 2019, 2019, 2019],\n    'Actual': [\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Heavy'].iloc[0],\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Medium'].iloc[0],\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Light'].iloc[0],\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Heavy'].iloc[0],\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Medium'].iloc[0],\n        df_VehicleMiles_Truck.loc[df_VehicleMiles_Truck['Year'] == 2019, 'Light'].iloc[0]\n    ],\n    'Trend': [\n        np.poly1d(np.polyfit(pd.to_numeric(df_VehicleMiles_Truck['Year']),\n                            pd.to_numeric(df_VehicleMiles_Truck['Heavy']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_VehicleMiles_Truck['Year']),\n                            pd.to_numeric(df_VehicleMiles_Truck['Medium']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_VehicleMiles_Truck['Year']),\n                            pd.to_numeric(df_VehicleMiles_Truck['Light']), 1))(2019),\n        # Last 3: Use only data from 2000+\n        np.poly1d(np.polyfit(\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Year']),\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Heavy']), 1))(2019),\n        np.poly1d(np.polyfit(\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Year']),\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Medium']), 1))(2019),\n        np.poly1d(np.polyfit(\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Year']),\n          pd.to_numeric(df_VehicleMiles_Truck[df_VehicleMiles_Truck['Year'] >= 2000]['Light']), 1))(2019)\n    ]\n}, index=['Heavy Trucks  - 1980+', 'Medium Trucks  - 1980+', 'Light Trucks  - 1980+',\n'Heavy Trucks  - 2000+', 'Medium Trucks  - 2000+', 'Light Trucks  - 2000+']).round(2)\n\n# TODO: '1980+' should be changed to '1990+'\n\ndf_VMTrucks_Comparision\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Actual</th>\n      <th>Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Heavy Trucks  - 1980+</th>\n      <td>2019</td>\n      <td>59.93</td>\n      <td>66.36</td>\n    </tr>\n    <tr>\n      <th>Medium Trucks  - 1980+</th>\n      <td>2019</td>\n      <td>12.28</td>\n      <td>13.22</td>\n    </tr>\n    <tr>\n      <th>Light Trucks  - 1980+</th>\n      <td>2019</td>\n      <td>11.60</td>\n      <td>11.46</td>\n    </tr>\n    <tr>\n      <th>Heavy Trucks  - 2000+</th>\n      <td>2019</td>\n      <td>59.93</td>\n      <td>63.71</td>\n    </tr>\n    <tr>\n      <th>Medium Trucks  - 2000+</th>\n      <td>2019</td>\n      <td>12.28</td>\n      <td>12.85</td>\n    </tr>\n    <tr>\n      <th>Light Trucks  - 2000+</th>\n      <td>2019</td>\n      <td>11.60</td>\n      <td>11.04</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Fuel Economy\n\n#### Create Dataframe\n\n::: {#d591b8b0 .cell execution_count=36}\n``` {.python .cell-code}\n# Define year range\nyear_range = [1980, 1985] + list(range(1990, 2020)) # Last year of the range should be one more than desired\n\n# Ensure column names are strings in both DataFrames to avoid indexing issues\ndf_FE_LightDuty.columns = df_FE_LightDuty.columns.astype(str)\ndf_FE_Medium.columns = df_FE_Medium.columns.astype(str)\ndf_FE_Heavy.columns = df_FE_Heavy.columns.astype(str)\n\n# Compile data from Raw Datasets\ndf_FuelEconomy = pd.DataFrame({\n  \"Year\": year_range,\n  \"Light Duty\": pd.to_numeric(\n    df_FE_LightDuty.loc[0, str(year_range[0]):str(year_range[-1])].values,\n    errors=\"coerce\"\n  ),\n  \"Medium Duty\": pd.to_numeric(\n    df_FE_Medium.loc[4, str(year_range[0]):str(year_range[-1])].values, # FIXED: Mistake in original calculation; use this instead\n    errors=\"coerce\"\n  ),\n  \"Heavy Duty\": pd.to_numeric(\n    df_FE_Heavy.loc[4, str(year_range[0]):str(year_range[-1])].values, # FIXED: Mistake in original calculation; use this instead\n    errors=\"coerce\"\n  )\n})\n\n# View the dataset\ndf_FuelEconomy\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Light Duty</th>\n      <th>Medium Duty</th>\n      <th>Heavy Duty</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1980</td>\n      <td>14.900000</td>\n      <td>5.751024</td>\n      <td>5.267929</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1985</td>\n      <td>16.500000</td>\n      <td>6.141193</td>\n      <td>5.573818</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1990</td>\n      <td>18.800000</td>\n      <td>6.210733</td>\n      <td>5.847737</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1991</td>\n      <td>19.500000</td>\n      <td>6.472767</td>\n      <td>5.749700</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1992</td>\n      <td>19.500000</td>\n      <td>6.540576</td>\n      <td>5.780000</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1993</td>\n      <td>19.200000</td>\n      <td>6.688396</td>\n      <td>5.810000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1994</td>\n      <td>19.391913</td>\n      <td>6.785380</td>\n      <td>5.833361</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1995</td>\n      <td>19.602243</td>\n      <td>6.803876</td>\n      <td>5.837586</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1996</td>\n      <td>19.691458</td>\n      <td>6.809732</td>\n      <td>5.912689</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>1997</td>\n      <td>19.700000</td>\n      <td>6.985442</td>\n      <td>6.136631</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>1998</td>\n      <td>19.792902</td>\n      <td>9.977427</td>\n      <td>5.102120</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>1999</td>\n      <td>19.616980</td>\n      <td>9.872225</td>\n      <td>5.045112</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2000</td>\n      <td>20.025918</td>\n      <td>7.372130</td>\n      <td>5.260719</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2001</td>\n      <td>20.235501</td>\n      <td>7.488557</td>\n      <td>5.351787</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2002</td>\n      <td>20.081724</td>\n      <td>7.350921</td>\n      <td>5.239386</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2003</td>\n      <td>19.500192</td>\n      <td>8.754982</td>\n      <td>5.883919</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2004</td>\n      <td>19.644668</td>\n      <td>8.755922</td>\n      <td>5.885270</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2005</td>\n      <td>20.174052</td>\n      <td>8.261740</td>\n      <td>5.201696</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2006</td>\n      <td>20.435839</td>\n      <td>8.154805</td>\n      <td>5.058217</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2007</td>\n      <td>21.275150</td>\n      <td>7.354144</td>\n      <td>5.960288</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2008</td>\n      <td>21.824862</td>\n      <td>7.399570</td>\n      <td>6.015066</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2009</td>\n      <td>21.696378</td>\n      <td>7.396154</td>\n      <td>5.992856</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2010</td>\n      <td>21.525254</td>\n      <td>7.335344</td>\n      <td>5.873992</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2011</td>\n      <td>21.367594</td>\n      <td>7.302138</td>\n      <td>5.812110</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2012</td>\n      <td>21.550948</td>\n      <td>7.345698</td>\n      <td>5.848071</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2013</td>\n      <td>21.634777</td>\n      <td>7.349478</td>\n      <td>5.849476</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2014</td>\n      <td>21.402991</td>\n      <td>7.338686</td>\n      <td>5.832550</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2015</td>\n      <td>21.979313</td>\n      <td>7.380038</td>\n      <td>5.893747</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2016</td>\n      <td>22.038465</td>\n      <td>7.389125</td>\n      <td>5.906246</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2017</td>\n      <td>22.274363</td>\n      <td>7.442531</td>\n      <td>5.977236</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2018</td>\n      <td>22.497301</td>\n      <td>7.506099</td>\n      <td>6.073034</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>2019</td>\n      <td>22.244734</td>\n      <td>7.489205</td>\n      <td>6.047802</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n::: {#fed08995 .cell execution_count=37}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Variable with a red line\nsns.lineplot(data=df_FuelEconomy, x=\"Year\", y=\"Light Duty\",\nlinewidth=2.5,color=\"#0070C0\", label=\"Light Duty\")\n\n# Plot Variable with a red line\nsns.lineplot(data=df_FuelEconomy, x=\"Year\", y=\"Medium Duty\",\nlinewidth=2.5,color=\"#FF0000\", label=\"Medium Duty\")\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_FuelEconomy, x=\"Year\", y=\"Heavy Duty\",\nlinewidth=2.5, color=\"#00B050\", label=\"Heavy Duty\")\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_FuelEconomy, x='Year', y='Light Duty',\n            scatter=False, color='#0070C0', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_FuelEconomy, x='Year', y='Medium Duty',\n            scatter=False, color='#FF0000', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Plotting the linear trend lines with dashed lines\nsns.regplot(data=df_FuelEconomy, x='Year', y='Heavy Duty',\n            scatter=False, color='#00B050', ci=None,\n            line_kws={'linestyle': '--', 'linewidth': 2, 'alpha': 0.8})\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Average Fuel Economy (miles per gallon)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Year', fontsize=13)\nplt.ylabel('Miles Travelled per Gallon', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(df_FuelEconomy['Year'], rotation=90)\n\nplt.legend(loc='upper left', fontsize=11)\n\n# Set y-axis limits to extend to 25\nplt.ylim(0, 25)\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-38-output-1.png){width=949 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n::: {#f567ae70 .cell execution_count=38}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ndf_FuelEconomy_Comparision = pd.DataFrame({\n    'Date': [2019, 2019, 2019],\n    'Actual': [\n        df_FuelEconomy.loc[df_FuelEconomy['Year'] == 2019, 'Light Duty'].iloc[0],\n        df_FuelEconomy.loc[df_FuelEconomy['Year'] == 2019, 'Medium Duty'].iloc[0],\n        df_FuelEconomy.loc[df_FuelEconomy['Year'] == 2019, 'Heavy Duty'].iloc[0]\n    ],\n    'Trend': [\n        np.poly1d(np.polyfit(pd.to_numeric(df_FuelEconomy['Year']),\n                            pd.to_numeric(df_FuelEconomy['Light Duty']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_FuelEconomy['Year']),\n                            pd.to_numeric(df_FuelEconomy['Medium Duty']), 1))(2019),\n        np.poly1d(np.polyfit(pd.to_numeric(df_FuelEconomy['Year']),\n                            pd.to_numeric(df_FuelEconomy['Heavy Duty']), 1))(2019)\n    ]\n}, index=['Light Duty', 'Medium Duty', 'Heavy Duty']).round(2)\n\ndf_FuelEconomy_Comparision\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Actual</th>\n      <th>Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Light Duty</th>\n      <td>2019</td>\n      <td>22.24</td>\n      <td>22.69</td>\n    </tr>\n    <tr>\n      <th>Medium Duty</th>\n      <td>2019</td>\n      <td>7.49</td>\n      <td>7.93</td>\n    </tr>\n    <tr>\n      <th>Heavy Duty</th>\n      <td>2019</td>\n      <td>6.05</td>\n      <td>5.90</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Fuel Costs\n\n#### Create Dataframe\n\n::: {#4aa0183f .cell execution_count=39}\n``` {.python .cell-code}\n# Generate the date range between the desired dates\ndate_range = pd.date_range(\"1994-01-03\", \"2021-12-27\", freq=\"D\")\n\n# Compile data from Raw Datasets\ndf_FuelCosts = pd.DataFrame({\n  \"Date\": df_RetailGasPrices[df_RetailGasPrices['Date'].isin(date_range)]['Date'].values\n})\n\n# Merge Gasoline and Diesel prices directly\ndf_FuelCosts = df_FuelCosts.merge(df_RetailGasPrices[['Date', 'Weekly Rocky Mountain All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)']], on='Date', how='left') \\\n                            .merge(df_RetailDieselPrices[['Date', 'Weekly Rocky Mountain No 2 Diesel Retail Prices  (Dollars per Gallon)']], on='Date', how='left')\n\n# Rename columns\ndf_FuelCosts.rename(columns={\n    'Weekly Rocky Mountain All Grades All Formulations Retail Gasoline Prices  (Dollars per Gallon)': 'Gasoline $/gal',\n    'Weekly Rocky Mountain No 2 Diesel Retail Prices  (Dollars per Gallon)': 'Diesel $/gal'\n}, inplace=True)\n\n# View the dataset\ndf_FuelCosts\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Gasoline $/gal</th>\n      <th>Diesel $/gal</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1994-01-03</td>\n      <td>1.085</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1994-01-10</td>\n      <td>1.065</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1994-01-17</td>\n      <td>1.092</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1994-01-24</td>\n      <td>1.075</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1994-01-31</td>\n      <td>1.063</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1456</th>\n      <td>2021-11-29</td>\n      <td>3.612</td>\n      <td>3.824</td>\n    </tr>\n    <tr>\n      <th>1457</th>\n      <td>2021-12-06</td>\n      <td>3.579</td>\n      <td>3.780</td>\n    </tr>\n    <tr>\n      <th>1458</th>\n      <td>2021-12-13</td>\n      <td>3.543</td>\n      <td>3.758</td>\n    </tr>\n    <tr>\n      <th>1459</th>\n      <td>2021-12-20</td>\n      <td>3.520</td>\n      <td>3.731</td>\n    </tr>\n    <tr>\n      <th>1460</th>\n      <td>2021-12-27</td>\n      <td>3.499</td>\n      <td>3.704</td>\n    </tr>\n  </tbody>\n</table>\n<p>1461 rows × 3 columns</p>\n</div>\n```\n:::\n:::\n\n\n#### Plotting Trends\n\n##### Retail Gasoline Prices - Rocky Mountain (1994 - 2022)\n\n::: {#95a07f40 .cell execution_count=40}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_FuelCosts, x=\"Date\", y=\"Gasoline $/gal\",\nlinewidth=2.5, color=\"#0070C0\", label=None)\n\n# Calculate and plot regression line inline\nplt.plot(\n    df_FuelCosts['Date'],\n    stats.linregress(\n        pd.to_numeric(df_FuelCosts['Date']),\n        df_FuelCosts['Gasoline $/gal']\n    )[1] + stats.linregress(\n        pd.to_numeric(df_FuelCosts['Date']),\n        df_FuelCosts['Gasoline $/gal']\n    )[0] * pd.to_numeric(df_FuelCosts['Date']),\n    color='#FF0000', linestyle='-', linewidth=2, alpha=0.8\n)\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Retail Gasoline Prices ($ per gallon) - Rocky Mountain (1994 - 2022)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Date', fontsize=13)\nplt.ylabel('USD', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(pd.to_datetime(df_FuelCosts['Date']).dt.to_period('Y').unique()[::2], rotation=90)\nplt.yticks(np.arange(0, 5.5, 0.5))\n\n# Set the x-axis limits to be between the min and max of the Date column\nplt.xlim(df_FuelCosts['Date'].min(), df_FuelCosts['Date'].max())\n# Set y-axis limits to extend to 5\nplt.ylim(0, 5)\n\n# Format the x-axis to display dates properly\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-41-output-1.png){width=949 height=566}\n:::\n:::\n\n\n##### Retail Gasoline Prices - Rocky Mountain (2005 - 2022)\n\n::: {#8333c7db .cell execution_count=41}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_FuelCosts, x=\"Date\", y=\"Gasoline $/gal\",\nlinewidth=2.5, color=\"#0070C0\", label=None)\n\n# Calculate and plot regression line for filtered data inline\nplt.plot(\n    df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date'],\n    stats.linregress(\n        pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n        df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Gasoline $/gal']\n    )[1] + stats.linregress(\n        pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n        df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Gasoline $/gal']\n    )[0] * pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n    color='#FF0000', linestyle='-', linewidth=2, alpha=0.8\n)\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Retail Gasoline Prices ($ per gallon) - Rocky Mountain (2005 - 2022)', fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Date', fontsize=13)\nplt.ylabel('USD', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(pd.to_datetime(df_FuelCosts['Date']).dt.to_period('Y').unique(), rotation=90)\nplt.yticks(np.arange(0, 5.5, 0.5))\n\n# Set the x-axis limits to be between the min and max of the Date column\nplt.xlim(pd.to_datetime(\"2005-01-01\"), df_FuelCosts['Date'].max())\n# Set y-axis limits to extend to 5\nplt.ylim(0, 5)\n\n# Format the x-axis to display dates properly\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-42-output-1.png){width=949 height=566}\n:::\n:::\n\n\n##### Retail Diesel Prices - Rocky Mountain (1994 - 2022)\n\n::: {#9d91e38e .cell execution_count=42}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_FuelCosts, x=\"Date\", y=\"Diesel $/gal\",\nlinewidth=2.5, color=\"#0070C0\", label=None)\n\n# Calculate and plot regression line inline\nplt.plot(\n    df_FuelCosts.dropna(subset=['Diesel $/gal'])['Date'],\n    stats.linregress(\n        pd.to_numeric(df_FuelCosts.dropna(subset=['Diesel $/gal'])['Date']),\n        df_FuelCosts.dropna(subset=['Diesel $/gal'])['Diesel $/gal']\n    )[1] + stats.linregress(\n        pd.to_numeric(df_FuelCosts.dropna(subset=['Diesel $/gal'])['Date']),\n        df_FuelCosts.dropna(subset=['Diesel $/gal'])['Diesel $/gal']\n    )[0] * pd.to_numeric(df_FuelCosts.dropna(subset=['Diesel $/gal'])['Date']),\n    color='#FF0000', linestyle='-', linewidth=2, alpha=0.8\n)\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Retail Diesel Prices ($ per gallon) - Rocky Mountain (1994 - 2022)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Date', fontsize=13)\nplt.ylabel('USD', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(pd.to_datetime(df_FuelCosts['Date']).dt.to_period('Y').unique()[::2], rotation=90)\nplt.yticks(np.arange(0, 5.5, 0.5))\n\n# Set the x-axis limits to be between the min and max of the Date column\nplt.xlim(df_FuelCosts['Date'].min(), df_FuelCosts['Date'].max())\n# Set y-axis limits to extend to 5\nplt.ylim(0, 5)\n\n# Format the x-axis to display dates properly\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-43-output-1.png){width=949 height=566}\n:::\n:::\n\n\n##### Retail Diesel Prices - Rocky Mountain (2005 - 2022)\n\n::: {#5fc1b1e0 .cell execution_count=43}\n``` {.python .cell-code}\n# Plotting the data using Seaborn and Matplotlib\nplt.figure(figsize=(10, 6))\n\n# Plot Fixed with a green line\nsns.lineplot(data=df_FuelCosts, x=\"Date\", y=\"Diesel $/gal\",\nlinewidth=2.5, color=\"#0070C0\", label=None)\n\n# Plot regression line for dates from 2005 onwards\nplt.plot(\n    df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date'],\n    stats.linregress(\n        pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n        df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Diesel $/gal'].dropna()\n    )[1] + stats.linregress(\n        pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n        df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Diesel $/gal'].dropna()\n    )[0] * pd.to_numeric(df_FuelCosts[df_FuelCosts['Date'] >= pd.to_datetime(\"2005-01-01\")]['Date']),\n    color='#FF0000', linestyle='-', linewidth=2, alpha=0.8\n)\n\n# Format y-axis as currency with comma separation using anonymous function\nplt.gca().yaxis.set_major_formatter(FuncFormatter(lambda x, p: f'${x:,.2f}'))\n\n# Customize the plot\nplt.title('Retail Diesel Prices ($ per gallon) - Rocky Mountain (2005 - 2022)',\n          fontsize=16, fontweight='bold', pad=20)\nplt.xlabel('Date', fontsize=13)\nplt.ylabel('USD', fontsize=13)\n\n# Show all x-axis labels with 90-degree rotation\nplt.xticks(pd.to_datetime(df_FuelCosts['Date']).dt.to_period('Y').unique(), rotation=90)\nplt.yticks(np.arange(0, 5.5, 0.5))\n\n# Set the x-axis limits to be between the min and max of the Date column\nplt.xlim(pd.to_datetime(\"2005-01-01\"), df_FuelCosts['Date'].max())\n# Set y-axis limits to extend to 5\nplt.ylim(0, 5)\n\n# Format the x-axis to display dates properly\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\n\n# Add major and minor grid lines for better readability\nplt.grid(True, alpha=0.3, linestyle='-', linewidth=0.5, which='major')\n\n# Improve layout\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](0 - Auto Operating Cost - 2022-01-11_files/figure-html/cell-44-output-1.png){width=949 height=566}\n:::\n:::\n\n\n#### Actual vs Trend Comparision\n\n##### 1994 - 2022\n\n::: {#c44d6518 .cell execution_count=44}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ncomparison_dates = [pd.to_datetime(\"2019-01-01\"), pd.to_datetime(\"2019-12-31\"), pd.to_datetime(\"2019-07-01\")]\n\ndf_FuelCost_Comparison_1 = pd.DataFrame({\n    'Gasoline Trend': [\n        np.poly1d(np.polyfit(pd.to_datetime(df_FuelCosts.dropna(subset=['Date', 'Gasoline $/gal'])['Date']).astype('int64'),\n                           df_FuelCosts.dropna(subset=['Date', 'Gasoline $/gal'])['Gasoline $/gal'].astype(float), 1))(pd.to_datetime(date).value)\n        for date in comparison_dates\n    ],\n    'Diesel Trend': [\n        np.poly1d(np.polyfit(pd.to_datetime(df_FuelCosts.dropna(subset=['Date', 'Diesel $/gal'])['Date']).astype('int64'),\n                           df_FuelCosts.dropna(subset=['Date', 'Diesel $/gal'])['Diesel $/gal'].astype(float), 1))(pd.to_datetime(date).value)\n        for date in comparison_dates\n    ]\n}, index=comparison_dates).round(3)\n\ndf_FuelCost_Comparison_1\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Gasoline Trend</th>\n      <th>Diesel Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2019-01-01</th>\n      <td>3.146</td>\n      <td>3.453</td>\n    </tr>\n    <tr>\n      <th>2019-12-31</th>\n      <td>3.225</td>\n      <td>3.547</td>\n    </tr>\n    <tr>\n      <th>2019-07-01</th>\n      <td>3.185</td>\n      <td>3.500</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### 2005 - 2022\n\n::: {#8c733279 .cell execution_count=45}\n``` {.python .cell-code}\n# Create the comparison DataFrame\ncomparison_dates = [pd.to_datetime(\"2019-01-01\"), pd.to_datetime(\"2019-12-31\"), pd.to_datetime(\"2019-07-01\")]\n\n# Filter for dates >= 2005-01-01 and fit trends\ndate_filter = pd.to_datetime(df_FuelCosts['Date']) >= pd.to_datetime(\"2005-01-01\")\n\ndf_FuelCost_Comparison_2 = pd.DataFrame({\n    'Gasoline Trend': [\n        np.poly1d(np.polyfit(pd.to_datetime(df_FuelCosts[date_filter].dropna(subset=['Date', 'Gasoline $/gal'])['Date']).astype('int64'),\n                           df_FuelCosts[date_filter].dropna(subset=['Date', 'Gasoline $/gal'])['Gasoline $/gal'].astype(float), 1))(pd.to_datetime(date).value)\n        for date in comparison_dates\n    ],\n    'Diesel Trend': [\n        np.poly1d(np.polyfit(pd.to_datetime(df_FuelCosts[date_filter].dropna(subset=['Date', 'Diesel $/gal'])['Date']).astype('int64'),\n                           df_FuelCosts[date_filter].dropna(subset=['Date', 'Diesel $/gal'])['Diesel $/gal'].astype(float), 1))(pd.to_datetime(date).value)\n        for date in comparison_dates\n    ]\n}, index=comparison_dates).round(3)\n\ndf_FuelCost_Comparison_2\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Gasoline Trend</th>\n      <th>Diesel Trend</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2019-01-01</th>\n      <td>2.861</td>\n      <td>3.115</td>\n    </tr>\n    <tr>\n      <th>2019-12-31</th>\n      <td>2.862</td>\n      <td>3.114</td>\n    </tr>\n    <tr>\n      <th>2019-07-01</th>\n      <td>2.862</td>\n      <td>3.114</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Auto Operating Costs\n\nCalculate Auto Operating Cost - 2019\n\n::: {#d3f3e4de .cell execution_count=46}\n``` {.python .cell-code}\n# Autos\nAOC_Auto = (\n  # Get gasoline price per gallon for July 2019\n    df_FuelCost_Comparison_1.loc[pd.to_datetime(\"2019-07-01\"), 'Gasoline Trend'] /\n    # Divide by fuel economy (miles per gallon) to get gallons per mile\n    df_FuelEconomy_Comparision.loc['Light Duty', 'Trend'] * 100 +  # Convert to cents\n    # Add maintenance and tire costs per mile (already in cents)\n    df_AutoCost_Comparision.loc['Maint+Tires', 'Trend']\n)\n\n# Light Duty Trucks\nAOC_LT = (\n    # Fuel cost: (price per gallon / mpg) * 100 cents per dollar\n    df_FuelCost_Comparison_1.loc[pd.to_datetime(\"2019-07-01\"), 'Gasoline Trend'] /\n    df_FE_SizeClass_1[df_FE_SizeClass_1['Manufacturer\\'s gross vehicle weight class'] == 'Light truck subtotal']['2002 VIUS'].iloc[0] * 100 +\n    # Maintenance cost\n    df_AutoCost_Comparision.loc['Maint+Tires', 'Trend']\n)\n\n# Medium Duty Trucks\nAOC_MD = (\n    # Fuel cost: diesel price / medium duty mpg * 100\n    df_FuelCost_Comparison_1.loc[pd.to_datetime(\"2019-07-01\"), 'Diesel Trend'] /\n    df_FuelEconomy_Comparision.loc['Medium Duty', 'Trend'] * 100 +\n    # Maintenance cost: approximation as average of light and heavy\n    (df_AutoCost_Comparision.loc['Maint+Tires', 'Trend'] + (df_RepairMaintenanceCost_Heavy['CostMile'].mean() * 100)) / 2\n)\n\n# Heavy Duty Trucks\nAOC_HV = (\n    # Fuel cost: diesel price / heavy duty mpg * 100\n    df_FuelCost_Comparison_1.loc[pd.to_datetime(\"2019-07-01\"), 'Diesel Trend'] /\n    df_FuelEconomy_Comparision.loc['Heavy Duty', 'Trend'] * 100 +\n    # Maintenance cost\n    (df_RepairMaintenanceCost_Heavy['CostMile'].mean() * 100)\n)\n```\n:::\n\n\n## Export\n\n::: {#3f7f0f1e .cell execution_count=47}\n``` {.python .cell-code}\n# Create dataframe compiling data\ndf_AOC_export = pd.DataFrame({\n  'Auto Operating Costs': ['AOC_Auto', 'AOC_LT', 'AOC_MD', 'AOC_HV'],\n  'Cost (cent/mile)': [\n      AOC_Auto.round(1),\n      AOC_LT.round(1),\n      AOC_MD.round(1),\n      AOC_HV.round(1)\n    ]\n})\n\n# View the dataset\ndf_AOC_export\n```\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Auto Operating Costs</th>\n      <th>Cost (cent/mile)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>AOC_Auto</td>\n      <td>21.7</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>AOC_LT</td>\n      <td>27.3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>AOC_MD</td>\n      <td>55.6</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>AOC_HV</td>\n      <td>74.5</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "0 - Auto Operating Cost - 2022-01-11_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}